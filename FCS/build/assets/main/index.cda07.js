window.__require=function t(e,o,n){function i(c,a){if(!o[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var p="function"==typeof __require&&__require;if(!a&&p)return p(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var l=o[c]={exports:{}};e[c][0].call(l.exports,function(t){return i(e[c][1][t]||t)},l,l.exports,t,e,o,n)}return o[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<n.length;c++)i(n[c]);return i}({AudioManager:[function(t,e,o){"use strict";cc._RF.push(e,"d66a0PmN2FL+6JFPHl/Q3Ek","AudioManager");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.defaultBgm=null,e.bgmVolume=.5,e.sfxVolume=.5,e}var o;return i(e,t),o=e,e.getInstance=function(){if(!o._instance){var t=new cc.Node("AudioManager");o._instance=t.addComponent(o),cc.game.addPersistRootNode(t)}return o._instance},e.prototype.start=function(){cc.audioEngine.playMusic(this.defaultBgm,!0)},e._instance=null,r([s({type:cc.AudioClip})],e.prototype,"defaultBgm",void 0),o=r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],AutoSceneSwitcher:[function(t,e,o){"use strict";cc._RF.push(e,"e020aBolepIXan4LeAh3SiX","AutoSceneSwitcher");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.waitSeconds=4,e.targetScene="Menu",e.fadeNode=null,e}return i(e,t),e.prototype.start=function(){var t=this;this.scheduleOnce(function(){t.fadeAndSwitch()},this.waitSeconds)},e.prototype.fadeAndSwitch=function(){var t=this;this.fadeNode?(this.fadeNode.active=!0,this.fadeNode.opacity=0,cc.tween(this.fadeNode).to(1,{opacity:255}).call(function(){cc.director.loadScene(t.targetScene)}).start()):cc.director.loadScene(this.targetScene)},r([s],e.prototype,"waitSeconds",void 0),r([s],e.prototype,"targetScene",void 0),r([s(cc.Node)],e.prototype,"fadeNode",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],BGMManager:[function(t,e,o){"use strict";cc._RF.push(e,"a41a5Oxl5lNS7zD38mi0DH1","BGMManager"),Object.defineProperty(o,"__esModule",{value:!0}),cc.Class({extends:cc.Component,properties:{bgm:{default:null,type:cc.AudioSource}},onLoad:function(){cc.sys.isNative||!window.__BGM_LOADED__?(cc.game.addPersistRootNode(this.node),window.__BGM_LOADED__=!0,this.bgm.isPlaying||this.bgm.play()):this.node.destroy()},onDestroy:function(){console.warn("\u26a0\ufe0f BGMManager \u88ab\u6467\u6bc0\u4e86\uff01\uff01\u97f3\u6a02\u6703\u4e2d\u65b7\u5594\uff01")}}),cc._RF.pop()},{}],CameraAutoMove2D:[function(t,e,o){"use strict";cc._RF.push(e,"24435wrjCBF/6fJ8zyY5wjP","CameraAutoMove2D");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cameraNode=null,e.moveDuration=5,e.rotateDuration=3,e}return i(e,t),e.prototype.start=function(){this.moveCamera()},e.prototype.moveCamera=function(){var t=this.cameraNode.position,e=new cc.Vec3(t.x,t.y,3e3);cc.tween(this.cameraNode).to(this.moveDuration,{position:e}).start()},r([s(cc.Node)],e.prototype,"cameraNode",void 0),r([s],e.prototype,"moveDuration",void 0),r([s],e.prototype,"rotateDuration",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],CattyController:[function(t,e,o){"use strict";cc._RF.push(e,"b3d1eJPN6FIUJBMKY8Z1E0o","CattyController");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anim=null,e.girl1=null,e.girl2=null,e.speed=15,e.rb=null,e.state="idle",e.followTimer=0,e.followThreshold=7,e.deskContactTimer=0,e.inDeskContact=!1,e.currentAnim="",e.isDying=!1,e}return i(e,t),e.prototype.onLoad=function(){this.rb=this.getComponent(cc.RigidBody),this.anim||(this.anim=this.getComponent(cc.Animation)),this.state="walk",this.playAnim("goblin_run")},e.prototype.setTargetPlayers=function(t,e){this.girl1=t,this.girl2=e},e.prototype.update=function(t){var e,o;if("dead"!==this.state){var n=null===(e=this.girl1)||void 0===e?void 0:e.position,i=null===(o=this.girl2)||void 0===o?void 0:o.position,r=n&&i?this.node.position.sub(n).mag()<this.node.position.sub(i).mag()?n:i:n||i;r&&"idle"!==this.state&&(this.node.position.sub(r).mag()<150?this.followTimer+=t:this.followTimer=0,this.moveTowards(r,t),this.playAnim("goblin_run"),this.followTimer>this.followThreshold&&this.die()),this.inDeskContact&&!this.isDying?(this.deskContactTimer+=t,this.deskContactTimer>1&&"dead"!==this.state&&this.die()):this.deskContactTimer=0}},e.prototype.moveTowards=function(t,e){if("dead"!==this.state){var o=t.sub(this.node.position);o=o.normalize(),this.node.x+=o.x*this.speed*e,this.node.y+=o.y*this.speed*e,Math.abs(o.x)>.1&&(this.node.scaleX=o.x>0?1:-1)}},e.prototype.die=function(){var t=this;if("dead"!==this.state&&!this.isDying){if(this.isDying=!0,this.state="dead",this.inDeskContact=!1,this.unscheduleAllCallbacks(),!this.anim.getAnimationState("goblin_die"))return console.warn("\u2757\u627e\u4e0d\u5230 goblin_die \u52d5\u756b\uff0c\u76f4\u63a5\u92b7\u6bc0\u7bc0\u9ede"),void this.node.destroy();this.currentAnim="goblin_die",this.anim.play("goblin_die"),this.anim.once("finished",function(){t.node.destroy()},this)}},e.prototype.playAnim=function(t){"dead"!==this.state&&this.anim&&this.currentAnim!==t&&this.anim.getAnimationState(t)&&(this.anim.play(t),this.currentAnim=t)},e.prototype.onBeginContact=function(t,e,o){1===o.tag&&(this.inDeskContact=!0)},e.prototype.onEndContact=function(t,e,o){1===o.tag&&(this.inDeskContact=!1,this.deskContactTimer=0)},r([s(cc.Animation)],e.prototype,"anim",void 0),r([s(cc.Node)],e.prototype,"girl1",void 0),r([s(cc.Node)],e.prototype,"girl2",void 0),r([s],e.prototype,"speed",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],CattySpawner:[function(t,e,o){"use strict";cc._RF.push(e,"919b9Wo7K1LVKr8wpkg7M+p","CattySpawner");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cattyPrefab=null,e.spawnPoints=[],e.spawnInterval=6,e.timer=0,e}return i(e,t),e.prototype.update=function(t){this.timer+=t,this.timer>=this.spawnInterval&&(this.timer=0,this.spawnCatty())},e.prototype.spawnCatty=function(){if(this.cattyPrefab&&0!==this.spawnPoints.length){var t=Math.floor(Math.random()*this.spawnPoints.length),e=this.spawnPoints[t],o=cc.instantiate(this.cattyPrefab);o.setPosition(e.getPosition()),o.parent=this.node,console.log("\ud83d\udc31 \u751f\u6210\u4e00\u96bb\u9592\u6643\u4e2d\u7684 Catty")}},r([s({type:cc.Prefab})],e.prototype,"cattyPrefab",void 0),r([s({type:[cc.Node]})],e.prototype,"spawnPoints",void 0),r([s],e.prototype,"spawnInterval",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],CloseButton:[function(t,e,o){"use strict";cc._RF.push(e,"97e3an7XxlAkK98hmIpqpkU","CloseButton");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.targetNode=null,e}return i(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.closeTarget,this)},e.prototype.closeTarget=function(){this.targetNode&&(this.targetNode.active=!1)},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.closeTarget,this)},r([s(cc.Node)],e.prototype,"targetNode",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],ExpandButton:[function(t,e,o){"use strict";cc._RF.push(e,"d9222DM7tlGSJxp6TxFNNS4","ExpandButton");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dropdownMenu=null,e.isExpanded=!1,e}return i(e,t),e.prototype.onLoad=function(){this.dropdownMenu.active=!1,this.node.on(cc.Node.EventType.TOUCH_END,this.toggleMenu,this)},e.prototype.start=function(){this.dropdownMenu.active=!1},e.prototype.toggleMenu=function(){this.isExpanded=!this.isExpanded,this.isExpanded?this.showMenu():this.hideMenu()},e.prototype.showMenu=function(){this.dropdownMenu.active=!0,this.dropdownMenu.opacity=0,cc.tween(this.dropdownMenu).to(.2,{opacity:255}).start(),cc.Canvas.instance.node.on(cc.Node.EventType.TOUCH_START,this.onGlobalTouch,this)},e.prototype.hideMenu=function(){var t=this;cc.tween(this.dropdownMenu).to(.2,{opacity:0}).call(function(){t.dropdownMenu.active=!1,cc.Canvas.instance.node.off(cc.Node.EventType.TOUCH_START,t.onGlobalTouch,t)}).start()},e.prototype.onGlobalTouch=function(t){var e=this.node.parent.convertToNodeSpaceAR(t.getLocation());this.node.getBoundingBox().contains(e)||this.dropdownMenu.active&&this.dropdownMenu.getBoundingBox().contains(e)||(this.isExpanded=!1,this.hideMenu())},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.toggleMenu,this),cc.Canvas.instance.node.off(cc.Node.EventType.TOUCH_START,this.onGlobalTouch,this)},r([s(cc.Node)],e.prototype,"dropdownMenu",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],ExpandPage:[function(t,e,o){"use strict";cc._RF.push(e,"fcf08e/VE9J3Ja2mgUVSEyE","ExpandPage");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.content=null,e}return i(e,t),e.prototype.onLoad=function(){this.content&&(this.content.active=!1),this.node.on(cc.Node.EventType.TOUCH_END,this.toggleContent,this)},e.prototype.toggleContent=function(){this.content&&(this.content.active=!this.content.active)},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.toggleContent,this)},r([s(cc.Node)],e.prototype,"content",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],FirebaseManager:[function(t,e,o){"use strict";cc._RF.push(e,"a25420OsNtJyJ/DOoVJ/aos","FirebaseManager");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isInitialized=!1,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){null===o.instance?(o.instance=this,cc.game.addPersistRootNode(this.node)):this.node.destroy()},e.getInstance=function(){return o.instance},e.prototype.isFirebaseInitialized=function(){return this.isInitialized},e.prototype.getAuth=function(){if(!this.isInitialized)throw new Error("Firebase not initialized");return firebase.auth()},e.prototype.getDatabase=function(){if(!this.isInitialized)throw new Error("Firebase not initialized");return firebase.database()},e.getFirebaseManager=function(){if(null===o.instance){console.warn("FirebaseManager instance is null, creating a new one.");var t=new cc.Node("FirebaseManager");return cc.game.addPersistRootNode(t),t.addComponent(o)}return o.instance},e.instance=null,o=r([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],"GameManager-level1":[function(t,e,o){"use strict";cc._RF.push(e,"d3c16Y55dNMZqrsfuCz80aO","GameManager-level1");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=t("./PlayerModeSelector"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.girl1Prefab=null,e.girl2Prefab=null,e.spawnPoint1=null,e.spawnPoint2=null,e}var o;return i(e,t),o=e,e.prototype.start=function(){cc.director.getPhysicsManager().enabled=!0,cc.director.getCollisionManager().enabled=!0,cc.director.getPhysicsManager().gravity=cc.v2(0,0),this.spawnPlayers()},e.prototype.spawnPlayers=function(){var t=p.default.player_mode,e=0===o.selectedCharIndex?this.girl1Prefab:this.girl2Prefab,n=cc.instantiate(e);if(n.setPosition(this.spawnPoint1.getPosition()),this.node.addChild(n),1===t){var i=cc.instantiate(e);i.setPosition(this.spawnPoint2.getPosition()),this.node.addChild(i)}},e.selectedCharIndex=0,r([s(cc.Prefab)],e.prototype,"girl1Prefab",void 0),r([s(cc.Prefab)],e.prototype,"girl2Prefab",void 0),r([s(cc.Node)],e.prototype,"spawnPoint1",void 0),r([s(cc.Node)],e.prototype,"spawnPoint2",void 0),o=r([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./PlayerModeSelector":"PlayerModeSelector"}],GameManager:[function(t,e,o){"use strict";cc._RF.push(e,"7e7e8lp5ApCrrVO9eszSaPM","GameManager");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.defaultBgm=null,e}return i(e,t),e.prototype.onLoad=function(){cc.director.getPhysics3DManager().enabled=!0,console.log("3D \u7269\u7406\u7cfb\u7d71\u555f\u7528\u6210\u529f\uff01")},e.prototype.start=function(){cc.audioEngine.playMusic(this.defaultBgm,!0)},r([s({type:cc.AudioClip})],e.prototype,"defaultBgm",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],GamepadControls:[function(t,e,o){"use strict";cc._RF.push(e,"00044YejV5CopjyAHjis/Qj","GamepadControls");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.speed=200,e}return i(e,t),e.prototype.update=function(t){var e=(navigator.getGamepads?navigator.getGamepads():[])[0];if(e){var o=e.axes[0],n=e.axes[1],i=Math.abs(o)>.2?o:0,r=Math.abs(n)>.2?n:0,c=i*this.speed*t,a=-r*this.speed*t;this.node.x+=c,this.node.y+=a,Math.abs(i)>.1&&(this.node.scaleX=i>0?1:-1)}},r([s],e.prototype,"speed",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],GoToPage:[function(t,e,o){"use strict";cc._RF.push(e,"356c2MftY9EJYle3Icb0Eh8","GoToPage");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.goToPage,this)},e.prototype.goToPage=function(){cc.sys.localStorage.setItem("fromMenu","true"),cc.director.loadScene("selectScene")},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.goToPage,this)},r([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],GoblinController:[function(t,e,o){"use strict";cc._RF.push(e,"e0264LXsgZDUJ3VQpCmBurz","GoblinController");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anim=null,e.girl1=null,e.girl2=null,e.speed=15,e.rb=null,e.state="idle",e.followTimer=0,e.followThreshold=7,e.deskContactTimer=0,e.inDeskContact=!1,e.currentAnim="",e.isDying=!1,e}return i(e,t),e.prototype.onLoad=function(){this.rb=this.getComponent(cc.RigidBody),this.anim||(this.anim=this.getComponent(cc.Animation)),this.state="walk",this.playAnim("goblin_run")},e.prototype.setTargetPlayers=function(t,e){this.girl1=t,this.girl2=e},e.prototype.update=function(t){var e,o;if("dead"!==this.state){var n=null===(e=this.girl1)||void 0===e?void 0:e.position,i=null===(o=this.girl2)||void 0===o?void 0:o.position,r=n&&i?this.node.position.sub(n).mag()<this.node.position.sub(i).mag()?n:i:n||i;r&&"idle"!==this.state&&(this.node.position.sub(r).mag()<150?this.followTimer+=t:this.followTimer=0,this.moveTowards(r,t),this.playAnim("goblin_run"),this.followTimer>this.followThreshold&&this.die()),this.inDeskContact&&!this.isDying?(this.deskContactTimer+=t,this.deskContactTimer>1&&"dead"!==this.state&&this.die()):this.deskContactTimer=0}},e.prototype.moveTowards=function(t,e){if("dead"!==this.state){var o=t.sub(this.node.position);o=o.normalize(),this.node.x+=o.x*this.speed*e,this.node.y+=o.y*this.speed*e,Math.abs(o.x)>.1&&(this.node.scaleX=o.x>0?1:-1)}},e.prototype.die=function(){var t=this;if("dead"!==this.state&&!this.isDying){if(this.isDying=!0,this.state="dead",this.inDeskContact=!1,this.unscheduleAllCallbacks(),!this.anim.getAnimationState("goblin_die"))return console.warn("\u2757\u627e\u4e0d\u5230 goblin_die \u52d5\u756b\uff0c\u76f4\u63a5\u92b7\u6bc0\u7bc0\u9ede"),void this.node.destroy();this.currentAnim="goblin_die",this.anim.play("goblin_die"),this.anim.once("finished",function(){t.node.destroy()},this)}},e.prototype.playAnim=function(t){"dead"!==this.state&&this.anim&&this.currentAnim!==t&&this.anim.getAnimationState(t)&&(this.anim.play(t),this.currentAnim=t)},e.prototype.onBeginContact=function(t,e,o){1===o.tag&&(this.inDeskContact=!0)},e.prototype.onEndContact=function(t,e,o){1===o.tag&&(this.inDeskContact=!1,this.deskContactTimer=0)},r([s(cc.Animation)],e.prototype,"anim",void 0),r([s(cc.Node)],e.prototype,"girl1",void 0),r([s(cc.Node)],e.prototype,"girl2",void 0),r([s],e.prototype,"speed",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],GoblinSpawner:[function(t,e,o){"use strict";cc._RF.push(e,"4e9cdyIB/NJs4XS87zuYtQ0","GoblinSpawner");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./GoblinController"),a=cc._decorator,s=a.ccclass,p=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.goblinPrefab=null,e.dropPoints=[],e.player1=null,e.player2=null,e.spawnInterval=5,e.timer=0,e}return i(e,t),e.prototype.update=function(t){this.timer+=t,this.timer>=this.spawnInterval&&(this.timer=0,this.spawnGoblin())},e.prototype.spawnGoblin=function(){if(this.goblinPrefab&&0!==this.dropPoints.length){var t=Math.floor(Math.random()*this.dropPoints.length),e=this.dropPoints[t],o=cc.instantiate(this.goblinPrefab);o.setPosition(e.getPosition()),o.parent=this.node;var n=o.getComponent(c.default);n&&this.player1&&this.player2&&n.setTargetPlayers(this.player1,this.player2)}},r([p({type:cc.Prefab})],e.prototype,"goblinPrefab",void 0),r([p({type:[cc.Node]})],e.prototype,"dropPoints",void 0),r([p({type:cc.Node})],e.prototype,"player1",void 0),r([p({type:cc.Node})],e.prototype,"player2",void 0),r([p],e.prototype,"spawnInterval",void 0),r([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./GoblinController":"GoblinController"}],IInputControls:[function(t,e,o){"use strict";cc._RF.push(e,"edf51f17O5PSo+huFJiPwhC","IInputControls"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],KeyboardControls2:[function(t,e,o){"use strict";cc._RF.push(e,"c8afc0tsPRMa4xzEslWQpMl","KeyboardControls2"),Object.defineProperty(o,"__esModule",{value:!0}),o.KeyboardControls2=void 0;var n=function(){function t(){this.moveDir=cc.v2(0,0),this.isInteractPressed=!1,this.isChopPressed=!1,this.isChopHeld=!1,this.isRunHeld=!1,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)}return t.prototype.getMoveDirection=function(){return this.moveDir},t.prototype.onKeyDown=function(t){switch(t.keyCode){case cc.macro.KEY.up:this.moveDir.y=1;break;case cc.macro.KEY.down:this.moveDir.y=-1;break;case cc.macro.KEY.left:this.moveDir.x=-1;break;case cc.macro.KEY.right:this.moveDir.x=1;break;case cc.macro.KEY.l:this.isInteractPressed=!0;break;case cc.macro.KEY.k:this.isChopHeld=!0;break;case cc.macro.KEY.shift:this.isRunHeld=!0}},t.prototype.onKeyUp=function(t){switch(t.keyCode){case cc.macro.KEY.up:case cc.macro.KEY.down:this.moveDir.y=0;break;case cc.macro.KEY.left:case cc.macro.KEY.right:this.moveDir.x=0;break;case cc.macro.KEY.l:this.isInteractPressed=!1;break;case cc.macro.KEY.k:this.isChopHeld=!1;break;case cc.macro.KEY.shift:this.isRunHeld=!1}},t.prototype.getInteractPressed=function(){return this.isInteractPressed},t.prototype.getChopPressed=function(){return this.isChopHeld},t.prototype.getRunHeld=function(){return this.isRunHeld},t}();o.KeyboardControls2=n,cc._RF.pop()},{}],KeyboardControls:[function(t,e,o){"use strict";cc._RF.push(e,"7c1a40Icb9Ko6LW+Qjg7m6O","KeyboardControls"),Object.defineProperty(o,"__esModule",{value:!0}),o.KeyboardControls=void 0;var n=function(){function t(){this.moveDir=cc.v2(0,0),this.isInteractPressed=!1,this.isChopPressed=!1,this.isChopHeld=!1,this.isRunHeld=!1,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)}return t.prototype.getMoveDirection=function(){return this.moveDir},t.prototype.onKeyDown=function(t){switch(t.keyCode){case cc.macro.KEY.w:this.moveDir.y=1;break;case cc.macro.KEY.s:this.moveDir.y=-1;break;case cc.macro.KEY.a:this.moveDir.x=-1;break;case cc.macro.KEY.d:this.moveDir.x=1;break;case cc.macro.KEY.e:this.isInteractPressed=!0;break;case cc.macro.KEY.space:this.isChopHeld=!0;break;case cc.macro.KEY.ctrl:this.isRunHeld=!0}},t.prototype.onKeyUp=function(t){switch(t.keyCode){case cc.macro.KEY.w:case cc.macro.KEY.s:this.moveDir.y=0;break;case cc.macro.KEY.a:case cc.macro.KEY.d:this.moveDir.x=0;break;case cc.macro.KEY.e:this.isInteractPressed=!1;break;case cc.macro.KEY.space:this.isChopHeld=!1;break;case cc.macro.KEY.ctrl:this.isRunHeld=!1}},t.prototype.getInteractPressed=function(){return this.isInteractPressed},t.prototype.getChopPressed=function(){return this.isChopHeld},t.prototype.getRunHeld=function(){return this.isRunHeld},t}();o.KeyboardControls=n,cc._RF.pop()},{}],Level2icecream1:[function(t,e,o){"use strict";cc._RF.push(e,"8f76ecjoFtBKYLLQLsri7mn","Level2icecream1");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./KeyboardControls"),a=t("../script/PlayerAnimationController"),s=cc._decorator,p=s.ccclass,l=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.conePrefab=null,e.vanillaPrefab=null,e.strawberryPrefab=null,e.chocolatePrefab=null,e.trashSmokePrefab=null,e.uiManager=null,e.tipsLabelPrefab=null,e.tipsParticlePrefab=null,e.anim=null,e.craftParticlePrefab=null,e.chopBarPrefab=null,e.pickupSound=null,e.blingSound=null,e.speed=200,e.runDustEffectPrefab=null,e.input=null,e.rb=null,e.currentAnim="",e.lastDir=cc.v2(0,-1),e.isRunning=!1,e.runMultiplier=1.3,e.runDustTimer=0,e.runDustInterval=.2,e.carriedDough=null,e.canPickCone=!1,e.canAddVanilla=!1,e.canAddStrawberry=!1,e.canAddChocolate=!1,e.canDeliver=!1,e.canTrash=!1,e.iceCreamProgress=0,e.menuManager=null,e.chopBar=null,e.chopFill=null,e}return i(e,t),e.prototype.onLoad=function(){var t;this.rb=this.getComponent(cc.RigidBody),this.menuManager=null===(t=this.uiManager)||void 0===t?void 0:t.getComponent("MenuBar"),this.input=new c.KeyboardControls;var e=0===a.default.player1CharIndex?"girl":"girl2";this.playAnim(e+"_idle_back");var o=cc.instantiate(this.chopBarPrefab);this.node.addChild(o),o.setPosition(cc.v2(0,80)),this.chopBar=o,this.chopFill=o.getChildByName("Fillbar"),o.active=!1},e.prototype.update=function(t){var e=this.input.getMoveDirection();if(this.isRunning=this.input.getRunHeld(),e.equals(cc.Vec2.ZERO))this.rb.linearVelocity=cc.v2(0,0),n=0===a.default.player1CharIndex?"girl":"girl2",Math.abs(this.lastDir.y)>Math.abs(this.lastDir.x)?this.playAnim(this.lastDir.y>0?n+"_idle_back":n+"_idle"):this.playAnim(this.lastDir.x>0?n+"_idle_right":n+"_idle_left"),this.node.scaleX=1;else{var o=this.speed;this.isRunning&&(o*=this.runMultiplier),this.rb.linearVelocity=e.clone().normalize().mul(o),this.lastDir=e.clone(),this.isRunning?(this.runDustTimer+=t,this.runDustTimer>=this.runDustInterval&&(this.runDustTimer=0,this.spawnRunDust())):this.runDustTimer=0;var n=0===a.default.player1CharIndex?"girl":"girl2";Math.abs(e.y)>Math.abs(e.x)?(e.y>0?this.playAnim(this.isRunning?n+"_run_back":n+"_walk_back"):this.playAnim(this.isRunning?n+"_run":n+"_walk"),this.node.scaleX=1):e.x>0?(this.playAnim(this.isRunning?n+"_run_right":n+"_walk_right"),this.node.scaleX=1):(this.playAnim(this.isRunning?n+"_run_left":n+"_walk_left"),this.node.scaleX=1),this.node.scaleX=1}if(this.carriedDough&&"Cone"===this.carriedDough.name&&this.input.getChopPressed()?(this.iceCreamProgress+=t,this.chopBar.active=!0,this.chopFill.scaleX=Math.min(this.iceCreamProgress/1,1),this.iceCreamProgress>=1&&(this.chopBar.active=!1,this.canAddVanilla?this.replaceWithIceCream("vanilla-icecream-menu",this.vanillaPrefab):this.canAddStrawberry?this.replaceWithIceCream("strawberry-icecream-menu",this.strawberryPrefab):this.canAddChocolate&&this.replaceWithIceCream("chocolate-icecream-menu",this.chocolatePrefab))):(this.chopBar.active=!1,this.iceCreamProgress=0,this.chopFill.scaleX=0),this.canDeliver&&this.input.getInteractPressed()&&this.carriedDough){var i=this.carriedDough.name,r=this.menuManager.slots.find(function(t){var e;return(null===(e=t.children[0])||void 0===e?void 0:e.name)===i});r?(this.carriedDough.destroy(),this.carriedDough=null,r.removeAllChildren(),this.menuManager.addScore(30),this.showDeliveryEffect(),this.menuManager.checkAndFillSlots(),this.blingSound&&cc.audioEngine.playEffect(this.blingSound,!1),console.log("\u2705 \u6210\u529f\u51fa\u9910\u51b0\u6dc7\u6dcb\uff1a"+i)):console.warn("\u274c \u51b0\u6dc7\u6dcb\u8207\u83dc\u55ae\u4e0d\u7b26\uff01")}if(this.canTrash&&this.input.getInteractPressed()&&this.carriedDough){if(this.carriedDough.destroy(),this.carriedDough=null,this.iceCreamProgress=0,this.chopBar.active=!1,this.chopFill.scaleX=0,this.trashSmokePrefab){var c=cc.instantiate(this.trashSmokePrefab);c.setPosition(this.node.getPosition()),this.node.parent.addChild(c),cc.tween(c).to(1.5,{opacity:0}).call(function(){return c.destroy()}).start()}this.menuManager.addScore(-50),this.pickupSound&&cc.audioEngine.playEffect(this.pickupSound,!1),console.log("\ud83d\uddd1\ufe0f \u4e1f\u68c4\u624b\u4e0a\u7269\u54c1")}this.input.getInteractPressed()&&this.tryInteract()},e.prototype.tryInteract=function(){if(this.canPickCone&&!this.carriedDough){var t=cc.instantiate(this.conePrefab);t.name="Cone",t.setPosition(cc.v3(0,10,50)),this.node.addChild(t),this.carriedDough=t,this.anim&&this.anim.play("girl_pick"),this.pickupSound&&cc.audioEngine.playEffect(this.pickupSound,!1),console.log("\ud83c\udf66 \u62ff\u8d77\u751c\u7b52")}},e.prototype.replaceWithIceCream=function(t,e){if(this.carriedDough){this.carriedDough.destroy();var o=cc.instantiate(e);o.name=t,o.setPosition(cc.v2(0,2)),this.node.addChild(o),this.carriedDough=o,this.iceCreamProgress=0,this.chopBar.active=!1,this.chopFill.scaleX=0;var n=cc.instantiate(this.craftParticlePrefab);n.setPosition(this.node.getPosition()),this.node.parent.addChild(n),console.log("\ud83c\udf68 \u88fd\u4f5c\u5b8c\u6210\uff1a"+t)}},e.prototype.showDeliveryEffect=function(){var t=cc.instantiate(this.tipsLabelPrefab);t.setPosition(this.node.getPosition().add(cc.v2(0,100))),this.node.parent.addChild(t),cc.tween(t).by(1,{position:cc.v3(0,60,0),opacity:-255},{easing:"cubicOut"}).call(function(){return t.destroy()}).start();var e=cc.instantiate(this.tipsParticlePrefab);e.setPosition(this.node.getPosition()),this.node.parent.addChild(e)},e.prototype.spawnRunDust=function(){if(this.runDustEffectPrefab){var t=cc.instantiate(this.runDustEffectPrefab),e=this.node.getPosition();e.y-=40,t.setPosition(e),this.node.parent.addChild(t)}},e.prototype.playAnim=function(t){this.currentAnim!==t&&(this.currentAnim=t,this.anim.play(t))},e.prototype.onBeginContact=function(t,e,o){2===o.tag?this.canPickCone=!0:3===o.tag?this.canAddVanilla=!0:4===o.tag?this.canAddStrawberry=!0:5===o.tag?this.canAddChocolate=!0:6===o.tag?this.canDeliver=!0:7===o.tag&&(this.canTrash=!0)},e.prototype.onEndContact=function(t,e,o){2===o.tag?this.canPickCone=!1:3===o.tag?this.canAddVanilla=!1:4===o.tag?this.canAddStrawberry=!1:5===o.tag?this.canAddChocolate=!1:6===o.tag?this.canDeliver=!1:7===o.tag&&(this.canTrash=!1)},r([l(cc.Prefab)],e.prototype,"conePrefab",void 0),r([l(cc.Prefab)],e.prototype,"vanillaPrefab",void 0),r([l(cc.Prefab)],e.prototype,"strawberryPrefab",void 0),r([l(cc.Prefab)],e.prototype,"chocolatePrefab",void 0),r([l(cc.Prefab)],e.prototype,"trashSmokePrefab",void 0),r([l(cc.Node)],e.prototype,"uiManager",void 0),r([l(cc.Prefab)],e.prototype,"tipsLabelPrefab",void 0),r([l(cc.Prefab)],e.prototype,"tipsParticlePrefab",void 0),r([l(cc.Animation)],e.prototype,"anim",void 0),r([l(cc.Prefab)],e.prototype,"craftParticlePrefab",void 0),r([l(cc.Prefab)],e.prototype,"chopBarPrefab",void 0),r([l({type:cc.AudioClip})],e.prototype,"pickupSound",void 0),r([l({type:cc.AudioClip})],e.prototype,"blingSound",void 0),r([l],e.prototype,"speed",void 0),r([l(cc.Prefab)],e.prototype,"runDustEffectPrefab",void 0),r([p],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../script/PlayerAnimationController":"PlayerAnimationController","./KeyboardControls":"KeyboardControls"}],Level2icecream2:[function(t,e,o){"use strict";cc._RF.push(e,"8ca28HfNU9JoLEmEFSbIXJw","Level2icecream2");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./KeyboardControls2"),a=t("../script/PlayerModeSelector"),s=t("../script/PlayerAnimationController"),p=cc._decorator,l=p.ccclass,h=p.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.conePrefab=null,e.vanillaPrefab=null,e.strawberryPrefab=null,e.chocolatePrefab=null,e.trashSmokePrefab=null,e.uiManager=null,e.tipsLabelPrefab=null,e.tipsParticlePrefab=null,e.anim=null,e.craftParticlePrefab=null,e.chopBarPrefab=null,e.pickupSound=null,e.blingSound=null,e.speed=200,e.runDustEffectPrefab=null,e.input=null,e.rb=null,e.currentAnim="",e.lastDir=cc.v2(0,-1),e.isRunning=!1,e.runMultiplier=1.3,e.runDustTimer=0,e.runDustInterval=.2,e.carriedDough=null,e.canPickCone=!1,e.canAddVanilla=!1,e.canAddStrawberry=!1,e.canAddChocolate=!1,e.canDeliver=!1,e.canTrash=!1,e.iceCreamProgress=0,e.menuManager=null,e.chopBar=null,e.chopFill=null,e}return i(e,t),e.prototype.onLoad=function(){var t;if(0!==a.default.player_mode){this.rb=this.getComponent(cc.RigidBody),this.menuManager=null===(t=this.uiManager)||void 0===t?void 0:t.getComponent("MenuBar"),this.input=new c.KeyboardControls2;var e=0===s.default.player2CharIndex?"girl":"girl2";this.playAnim(e+"_idle_back");var o=cc.instantiate(this.chopBarPrefab);this.node.addChild(o),o.setPosition(cc.v2(0,80)),this.chopBar=o,this.chopFill=o.getChildByName("Fillbar"),o.active=!1}else this.node.active=!1},e.prototype.update=function(t){if(0!==a.default.player_mode){var e=this.input.getMoveDirection();if(this.isRunning=this.input.getRunHeld(),e.equals(cc.Vec2.ZERO))this.rb.linearVelocity=cc.v2(0,0),n=0===s.default.player2CharIndex?"girl":"girl2",Math.abs(this.lastDir.y)>Math.abs(this.lastDir.x)?this.playAnim(this.lastDir.y>0?n+"_idle_back":n+"_idle"):this.playAnim(this.lastDir.x>0?n+"_idle_right":n+"_idle_left");else{var o=this.speed;this.isRunning&&(o*=this.runMultiplier),this.rb.linearVelocity=e.clone().normalize().mul(o),this.lastDir=e.clone(),this.isRunning?(this.runDustTimer+=t,this.runDustTimer>=this.runDustInterval&&(this.runDustTimer=0,this.spawnRunDust())):this.runDustTimer=0;var n=0===s.default.player2CharIndex?"girl":"girl2";Math.abs(e.y)>Math.abs(e.x)?(e.y>0?this.playAnim(this.isRunning?n+"_run_back":n+"_walk_back"):this.playAnim(this.isRunning?n+"_run":n+"_walk"),this.node.scaleX=1):e.x>0?(this.playAnim(this.isRunning?n+"_run_right":n+"_walk_right"),this.node.scaleX=1):(this.playAnim(this.isRunning?n+"_run_left":n+"_walk_left"),this.node.scaleX=1)}if(this.carriedDough&&"Cone"===this.carriedDough.name&&this.input.getChopPressed()?(this.iceCreamProgress+=t,this.chopBar.active=!0,this.chopFill.scaleX=Math.min(this.iceCreamProgress/1,1),this.iceCreamProgress>=1&&(this.chopBar.active=!1,this.canAddVanilla?this.replaceWithIceCream("vanilla-icecream-menu",this.vanillaPrefab):this.canAddStrawberry?this.replaceWithIceCream("strawberry-icecream-menu",this.strawberryPrefab):this.canAddChocolate&&this.replaceWithIceCream("chocolate-icecream-menu",this.chocolatePrefab))):(this.chopBar.active=!1,this.iceCreamProgress=0,this.chopFill.scaleX=0),this.canDeliver&&this.input.getInteractPressed()&&this.carriedDough){var i=this.carriedDough.name,r=this.menuManager.slots.find(function(t){var e;return(null===(e=t.children[0])||void 0===e?void 0:e.name)===i});r?(this.carriedDough.destroy(),this.carriedDough=null,r.removeAllChildren(),this.menuManager.addScore(30),this.showDeliveryEffect(),this.menuManager.checkAndFillSlots(),this.blingSound&&cc.audioEngine.playEffect(this.blingSound,!1),console.log("\u2705 \u6210\u529f\u51fa\u9910\u51b0\u6dc7\u6dcb\uff1a"+i)):console.warn("\u274c \u51b0\u6dc7\u6dcb\u8207\u83dc\u55ae\u4e0d\u7b26\uff01")}if(this.canTrash&&this.input.getInteractPressed()&&this.carriedDough){if(this.carriedDough.destroy(),this.carriedDough=null,this.iceCreamProgress=0,this.chopBar.active=!1,this.chopFill.scaleX=0,this.trashSmokePrefab){var c=cc.instantiate(this.trashSmokePrefab);c.setPosition(this.node.getPosition()),this.node.parent.addChild(c),cc.tween(c).to(1.5,{opacity:0}).call(function(){return c.destroy()}).start()}this.menuManager.addScore(-50),this.pickupSound&&cc.audioEngine.playEffect(this.pickupSound,!1),console.log("\ud83d\uddd1\ufe0f \u4e1f\u68c4\u624b\u4e0a\u7269\u54c1")}this.input.getInteractPressed()&&this.tryInteract()}else this.node.active=!1},e.prototype.tryInteract=function(){if(this.canPickCone&&!this.carriedDough){var t=cc.instantiate(this.conePrefab);t.name="Cone",t.setPosition(cc.v3(0,10,50)),this.node.addChild(t),this.carriedDough=t,this.anim&&this.anim.play("girl_pick"),this.pickupSound&&cc.audioEngine.playEffect(this.pickupSound,!1),console.log("\ud83c\udf66 \u62ff\u8d77\u751c\u7b52")}},e.prototype.replaceWithIceCream=function(t,e){if(this.carriedDough){this.carriedDough.destroy();var o=cc.instantiate(e);o.name=t,o.setPosition(cc.v2(0,2)),this.node.addChild(o),this.carriedDough=o,this.iceCreamProgress=0,this.chopBar.active=!1,this.chopFill.scaleX=0;var n=cc.instantiate(this.craftParticlePrefab);n.setPosition(this.node.getPosition()),this.node.parent.addChild(n),console.log("\ud83c\udf68 \u88fd\u4f5c\u5b8c\u6210\uff1a"+t)}},e.prototype.showDeliveryEffect=function(){var t=cc.instantiate(this.tipsLabelPrefab);t.setPosition(this.node.getPosition().add(cc.v2(0,100))),this.node.parent.addChild(t),cc.tween(t).by(1,{position:cc.v3(0,60,0),opacity:-255},{easing:"cubicOut"}).call(function(){return t.destroy()}).start();var e=cc.instantiate(this.tipsParticlePrefab);e.setPosition(this.node.getPosition()),this.node.parent.addChild(e)},e.prototype.spawnRunDust=function(){if(this.runDustEffectPrefab){var t=cc.instantiate(this.runDustEffectPrefab),e=this.node.getPosition();e.y-=40,t.setPosition(e),this.node.parent.addChild(t)}},e.prototype.playAnim=function(t){this.currentAnim!==t&&(this.currentAnim=t,this.anim.play(t))},e.prototype.onBeginContact=function(t,e,o){2===o.tag?this.canPickCone=!0:3===o.tag?this.canAddVanilla=!0:4===o.tag?this.canAddStrawberry=!0:5===o.tag?this.canAddChocolate=!0:6===o.tag?this.canDeliver=!0:7===o.tag&&(this.canTrash=!0)},e.prototype.onEndContact=function(t,e,o){2===o.tag?this.canPickCone=!1:3===o.tag?this.canAddVanilla=!1:4===o.tag?this.canAddStrawberry=!1:5===o.tag?this.canAddChocolate=!1:6===o.tag?this.canDeliver=!1:7===o.tag&&(this.canTrash=!1)},r([h(cc.Prefab)],e.prototype,"conePrefab",void 0),r([h(cc.Prefab)],e.prototype,"vanillaPrefab",void 0),r([h(cc.Prefab)],e.prototype,"strawberryPrefab",void 0),r([h(cc.Prefab)],e.prototype,"chocolatePrefab",void 0),r([h(cc.Prefab)],e.prototype,"trashSmokePrefab",void 0),r([h(cc.Node)],e.prototype,"uiManager",void 0),r([h(cc.Prefab)],e.prototype,"tipsLabelPrefab",void 0),r([h(cc.Prefab)],e.prototype,"tipsParticlePrefab",void 0),r([h(cc.Animation)],e.prototype,"anim",void 0),r([h(cc.Prefab)],e.prototype,"craftParticlePrefab",void 0),r([h(cc.Prefab)],e.prototype,"chopBarPrefab",void 0),r([h({type:cc.AudioClip})],e.prototype,"pickupSound",void 0),r([h({type:cc.AudioClip})],e.prototype,"blingSound",void 0),r([h],e.prototype,"speed",void 0),r([h(cc.Prefab)],e.prototype,"runDustEffectPrefab",void 0),r([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../script/PlayerAnimationController":"PlayerAnimationController","../script/PlayerModeSelector":"PlayerModeSelector","./KeyboardControls2":"KeyboardControls2"}],Login:[function(t,e,o){"use strict";cc._RF.push(e,"d7834lHPaBEErNbv6LSfhg7","Login");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.firebaseManager=null,e}return i(e,t),e.prototype.start=function(){var t=new cc.Component.EventHandler;t.target=this.node,t.component="Login",t.handler="onLogin",cc.find("Canvas/Login/Submit").getComponent(cc.Button).clickEvents.push(t)},e.prototype.onLogin=function(){var t=this,e=cc.find("Canvas/Login/Email").getComponent(cc.EditBox).string,o=cc.find("Canvas/Login/Password").getComponent(cc.EditBox).string;e&&o?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?(console.log("\u5617\u8a66\u767b\u5165:",e),this.firebaseManager.getAuth().signInWithEmailAndPassword(e,o).then(function(e){console.log("\u767b\u5165\u6210\u529f:",e.user.email);var o=cc.director.getScene().getChildByName("PersistentUser");if(o){var n=o.getComponent("PersistentUser");t.firebaseManager.getDatabase().ref("users/"+e.user.uid).once("value").then(function(o){var i=o.val()&&o.val().nickname?o.val().nickname:"";n.setUserInfo(e.user.uid,e.user.email,i),t.loadMenuPage()}).catch(function(){n.setUserInfo(e.user.uid,e.user.email,""),t.loadMenuPage()})}else console.warn("\u627e\u4e0d\u5230 PersistentUser persist node\uff01"),t.loadMenuPage()})):alert("\u8acb\u8f38\u5165\u6709\u6548\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740"):alert("\u8acb\u586b\u5beb\u6240\u6709\u6b04\u4f4d")},e.prototype.loadMenuPage=function(){cc.director.loadScene("Loading")},r([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],MenuManager:[function(t,e,o){"use strict";cc._RF.push(e,"65d86/Kq/FIHZLi3KNNf8TX","MenuManager");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./AudioManager"),a=cc._decorator,s=a.ccclass,p=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgm=null,e.bgmSlider=null,e.sfxSlider=null,e.scoreboardButton=null,e.bgmAudioId=-1,e}return i(e,t),e.prototype.start=function(){this.bgmAudioId=cc.audioEngine.play(this.bgm,!0,c.default.getInstance().bgmVolume),this.bgmSlider&&this.bgmSlider.getComponent(cc.Slider).node.on("slide",this.onBgmSliderChanged,this),this.sfxSlider&&this.sfxSlider.getComponent(cc.Slider).node.on("slide",this.onSfxSliderChanged,this),this.scoreboardButton&&this.scoreboardButton.node.on("click",this.onScoreboardButtonClicked,this)},e.prototype.onScoreboardButtonClicked=function(){cc.director.loadScene("scoreboard")},e.prototype.onBgmSliderChanged=function(t){c.default.getInstance().bgmVolume=t.progress,-1!==this.bgmAudioId&&cc.audioEngine.setVolume(this.bgmAudioId,t.progress)},e.prototype.onSfxSliderChanged=function(t){c.default.getInstance().sfxVolume=t.progress,cc.audioEngine.setEffectsVolume(t.progress)},e.prototype.onDestroy=function(){-1!==this.bgmAudioId&&cc.audioEngine.stop(this.bgmAudioId)},r([p({type:cc.AudioClip})],e.prototype,"bgm",void 0),r([p(cc.Node)],e.prototype,"bgmSlider",void 0),r([p(cc.Node)],e.prototype,"sfxSlider",void 0),r([p(cc.Button)],e.prototype,"scoreboardButton",void 0),r([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./AudioManager":"AudioManager"}],NPCWanderCatty:[function(t,e,o){"use strict";cc._RF.push(e,"a4e7blT7VtAm7dLpKzVc9HU","NPCWanderCatty");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anim=null,e.speed=50,e.direction=cc.v3(),e.moveTimer=0,e.animTimer=0,e}return i(e,t),e.prototype.onLoad=function(){this.anim||(this.anim=this.getComponent(cc.Animation)),this.pickRandomDirection(),this.playAnim("cat_run")},e.prototype.update=function(t){var e=this.direction.mag()>.1;e&&(this.node.x+=this.direction.x*this.speed*t,this.node.y+=this.direction.y*this.speed*t),this.moveTimer+=t,this.moveTimer>=2+2*Math.random()&&(this.pickRandomDirection(),this.moveTimer=0),e?this.playAnim("cat_run"):this.playAnim("cat_idle"),Math.abs(this.direction.x)>.1&&(this.node.scaleX=this.direction.x>0?5:-5)},e.prototype.pickRandomDirection=function(){var t=Math.random()*Math.PI*2;this.direction=cc.v3(Math.cos(t),Math.sin(t),0)},e.prototype.randomAnim=function(){var t=["cat_idle","cat_run","cat_jump"],e=t[Math.floor(Math.random()*t.length)];this.playAnim(e)},e.prototype.playAnim=function(t){this.anim&&this.anim.getAnimationState(t)&&this.anim.play(t)},r([s(cc.Animation)],e.prototype,"anim",void 0),r([s],e.prototype,"speed",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],NPCWanderGoblin:[function(t,e,o){"use strict";cc._RF.push(e,"2e63bAs29tP5I9SVWngM+bj","NPCWanderGoblin");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.minSpeed=30,e.maxSpeed=40,e.anim=null,e.dir=cc.v2(0,0),e.speed=0,e.rb=null,e}return i(e,t),e.prototype.start=function(){this.rb=this.getComponent(cc.RigidBody),this.schedule(this.pickRandomDirection,2*Math.random()+1),this.pickRandomDirection()},e.prototype.pickRandomDirection=function(){var t=Math.random()*Math.PI*2;this.dir=cc.v2(Math.cos(t),Math.sin(t)).normalize(),this.speed=this.minSpeed+Math.random()*(this.maxSpeed-this.minSpeed),this.anim&&this.anim.play("goblin_run")},e.prototype.update=function(){this.rb&&(this.rb.linearVelocity=this.dir.mul(this.speed),Math.abs(this.dir.x)>Math.abs(this.dir.y)&&(this.node.scaleX=this.dir.x>0?1:-1))},e.prototype.onBeginContact=function(t,e,o){"DeskCollider"===o.node.name&&(this.dir=cc.v2(0,0),this.speed=0,this.anim&&this.anim.play("goblin_idle"))},r([s],e.prototype,"minSpeed",void 0),r([s],e.prototype,"maxSpeed",void 0),r([s(cc.Animation)],e.prototype,"anim",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],OpenShop:[function(t,e,o){"use strict";cc._RF.push(e,"28e99itR19BcrP2D1EDaxIE","OpenShop");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.opendoor=null,e.opendoorAudioId=-1,e}return i(e,t),e.prototype.onLoad=function(){var t=this;this.node.setPosition(0,0),this.moveDown(),this.opendoorAudioId=cc.audioEngine.play(this.opendoor,!1,1),this.scheduleOnce(function(){cc.audioEngine.stop(t.opendoorAudioId)},6)},e.prototype.moveDown=function(){cc.tween(this.node).to(6,{position:cc.v3(0,400,0)}).start()},r([s(cc.AudioClip)],e.prototype,"opendoor",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],PauseManager:[function(t,e,o){"use strict";cc._RF.push(e,"f2aaefiP01D+7ECjkmppp4/","PauseManager");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pausePanelPrefab=null,e.pausePanelNode=null,e.isPaused=!1,e}return i(e,t),e.prototype.onLoad=function(){this.pausePanelPrefab&&(this.pausePanelNode=cc.instantiate(this.pausePanelPrefab),this.node.addChild(this.pausePanelNode),this.pausePanelNode.active=!1),this.isPaused=!1,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.onDestroy=function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.onKeyDown=function(t){t.keyCode===cc.macro.KEY.escape&&this.togglePause()},e.prototype.togglePause=function(){this.isPaused=!this.isPaused,this.isPaused?cc.director.pause():cc.director.resume(),this.pausePanelNode&&(this.pausePanelNode.active=this.isPaused)},e.prototype.isGamePaused=function(){return this.isPaused},r([s(cc.Prefab)],e.prototype,"pausePanelPrefab",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],PersistentUser:[function(t,e,o){"use strict";cc._RF.push(e,"8e072veo3dKyLSIYLFUgQqb","PersistentUser");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.userId="",e.email="",e.nickname="",e}return i(e,t),e.prototype.onLoad=function(){cc.game.isPersistRootNode(this.node)||(cc.game.addPersistRootNode(this.node),cc.log("[PersistentUser] addPersistRootNode"))},e.prototype.setUserInfo=function(t,e,o){void 0===e&&(e=""),void 0===o&&(o=""),this.userId=t,this.email=e,this.nickname=o,cc.sys.localStorage.setItem("userId",t),cc.sys.localStorage.setItem("email",e),cc.sys.localStorage.setItem("nickname",o)},r([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],PlayerAnimationController:[function(t,e,o){"use strict";cc._RF.push(e,"a348ewY38tOnYXPnHBjwP46","PlayerAnimationController");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.toggleGroupNode=null,e.player1=null,e.player2=null,e.buttonGirl=null,e.buttonGirl2=null,e.choosePlayerNode=null,e}var o;return i(e,t),o=e,e.prototype.start=function(){var t=this;this.buttonGirl.node.on("click",function(){t.assignCharIndex(0)},this),this.buttonGirl2.node.on("click",function(){t.assignCharIndex(1)},this)},e.prototype.getSelectedPlayer=function(){return!1===this.choosePlayerNode.active?this.player1:0===this.toggleGroupNode.getComponentsInChildren(cc.Toggle).findIndex(function(t){return t.isChecked})?this.player1:this.player2},e.prototype.assignCharIndex=function(t){this.getSelectedPlayer()===this.player1?o.player1CharIndex=t:o.player2CharIndex=t;var e=0===t?"girl":"girl2";this.changeAnimation(e+"_idle")},e.prototype.changeAnimation=function(t){var e=this.getSelectedPlayer();if(e){var o=e.getComponent(cc.Animation);o&&o.play(t)}},e.player1CharIndex=0,e.player2CharIndex=1,r([s(cc.Node)],e.prototype,"toggleGroupNode",void 0),r([s(cc.Node)],e.prototype,"player1",void 0),r([s(cc.Node)],e.prototype,"player2",void 0),r([s(cc.Button)],e.prototype,"buttonGirl",void 0),r([s(cc.Button)],e.prototype,"buttonGirl2",void 0),r([s(cc.Node)],e.prototype,"choosePlayerNode",void 0),o=r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],"PlayerController 2":[function(t,e,o){"use strict";cc._RF.push(e,"87520rn6R9PgK/e9WImxw2K","PlayerController 2");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./KeyboardControls2"),a=t("../script/PlayerModeSelector"),s=t("../script/PlayerAnimationController"),p=cc._decorator,l=p.ccclass,h=p.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anim=null,e.speed=200,e.doughPrefab=null,e.flatbreadPrefa=null,e.chopBarPrefab=null,e.cheesePrefab=null,e.gratedCheesePrefab=null,e.ppPrefab=null,e.sliceppPrefab=null,e.mushroomPrefab=null,e.slicemushroomPrefab=null,e.cheesePizzaPrefab=null,e.mushroomPizzaPrefab=null,e.pepperPizzaPrefab=null,e.smokeEffectPrefab=null,e.smokePoint=null,e.tipsLabelPrefab=null,e.tipsParticlePrefab=null,e.pizzaSteamPrefab=null,e.uiManager=null,e.chopSound=null,e.bakeSound=null,e.chopSoundTimer=0,e.bakeSoundId=-1,e.isRunning=!1,e.runMultiplier=1.3,e.runDustEffectPrefab=null,e.runDustTimer=0,e.runDustInterval=.2,e.blingSound=null,e.pickupSound=null,e.placeSound=null,e.canDeliver=!1,e.menuManager=null,e.nearbyOven=null,e.smokeTimer=0,e.smokeInterval=.5,e.input=null,e.currentAnim="",e.lastDir=cc.v2(0,-1),e.rb=null,e.canPickDough=!1,e.canDropDough=!1,e.carriedDough=null,e.currentDropTarget=null,e.currentDropTag=null,e.isChopping=!1,e.chopProgress=0,e.chopFill=null,e.chopBar=null,e.canPickCheese=!1,e.canPickPP=!1,e.canPickMushroom=!1,e.isBaking=!1,e.bakeProgress=0,e.isNearOven=!1,e.lastInteractTime=0,e.interactCooldown=.2,e}return i(e,t),e.prototype.start=function(){var t;if(0!==a.default.player_mode){var e=this.getComponent(cc.PhysicsBoxCollider);if(e&&(e.enabled=!0,e.apply()),this.anim||(this.anim=this.getComponent(cc.Animation)),this.rb=this.getComponent(cc.RigidBody),this.rb){var o=0===s.default.player2CharIndex?"girl":"girl2";this.playAnim(o+"_idle_back"),this.input=new c.KeyboardControls2;var n=cc.instantiate(this.chopBarPrefab);this.node.addChild(n),n.setPosition(cc.v2(0,80)),this.chopBar=n,this.chopFill=n.getChildByName("Fillbar"),this.chopFill||cc.error("\u274c \u627e\u4e0d\u5230 Fillbar\uff01"),n.active=!1,this.menuManager=null===(t=this.uiManager)||void 0===t?void 0:t.getComponent("MenuBar")}else cc.error("\u274c \u627e\u4e0d\u5230 RigidBody2D \u7d44\u4ef6\uff01")}else this.node.active=!1},e.prototype.update=function(t){var e=this.input.getMoveDirection();if(this.isRunning=this.input.getRunHeld(),e.equals(cc.Vec2.ZERO))this.rb.linearVelocity=cc.v2(0,0),n=0===s.default.player2CharIndex?"girl":"girl2",Math.abs(this.lastDir.y)>Math.abs(this.lastDir.x)?this.playAnim(this.lastDir.y>0?n+"_idle_back":n+"_idle"):this.playAnim(this.lastDir.x>0?n+"_idle_right":n+"_idle_left"),this.node.scaleX=1;else{this.isRunning?(this.rb.linearVelocity=e.clone().normalize().mul(this.speed*this.runMultiplier),this.runDustTimer+=t,this.runDustTimer>=this.runDustInterval&&(this.runDustTimer=0,this.spawnRunDust())):(this.rb.linearVelocity=e.clone().normalize().mul(this.speed),this.runDustTimer=0);var o=this.speed;this.isRunning&&(o*=this.runMultiplier),this.rb.linearVelocity=e.clone().normalize().mul(o),this.lastDir=e.clone();var n=0===s.default.player2CharIndex?"girl":"girl2";Math.abs(e.y)>Math.abs(e.x)?(e.y>0?this.playAnim(this.isRunning?n+"_run_back":n+"_walk_back"):this.playAnim(this.isRunning?n+"_run":n+"_walk"),this.node.scaleX=1):e.x>0?(this.playAnim(this.isRunning?n+"_run_right":n+"_walk_right"),this.node.scaleX=1):(this.playAnim(this.isRunning?n+"_run_left":n+"_walk_left"),this.node.scaleX=1)}if(this.input.getInteractPressed()){var i=Date.now()/1e3;i-this.lastInteractTime>this.interactCooldown&&(this.tryInteract(),this.lastInteractTime=i)}if(this.input.getChopPressed()&&this.canDropDough&&null==this.carriedDough&&!this.isChopping&&this.startChopping(),this.isChopping)if(this.input.getChopPressed()){this.chopProgress+=t;var r=Math.min(this.chopProgress/2,1);this.chopFill.scaleX=r,this.chopSoundTimer+=t,this.chopSoundTimer>=.2&&(this.chopSoundTimer=0,this.chopSound&&cc.audioEngine.playEffect(this.chopSound,!1)),this.chopProgress>=2&&this.finishChopping()}else this.cancelChopping();else this.chopSoundTimer=0;if(this.input.getChopPressed()&&this.isNearOven&&this.carriedDough&&this.isPizza(this.carriedDough.name)&&!this.carriedDough.baked&&!this.isBaking&&(this.isBaking=!0,this.bakeSound&&(this.bakeSoundId=cc.audioEngine.playEffect(this.bakeSound,!0)),this.bakeProgress=0,this.carriedDough.active=!1,this.chopBar.parent=this.node,this.chopBar.setPosition(cc.v2(0,80)),this.chopBar.active=!0,this.chopFill.scaleX=0,console.log("\ud83d\udd25 \u62ab\u85a9\u653e\u5165\u70e4\u7bb1\u4e2d...")),this.input.getChopPressed()&&this.isNearOven&&this.carriedDough&&this.isPizza(this.carriedDough.name)&&this.carriedDough.baked&&console.warn("\u26a0\ufe0f \u9019\u584a\u62ab\u85a9\u5df2\u7d93\u70e4\u904e\u4e86\uff0c\u4e0d\u80fd\u91cd\u8907\u70d8\u70e4\uff01"),this.isBaking&&this.input.getChopPressed()){this.bakeProgress+=t;var c=Math.min(this.bakeProgress/3,1);if(this.chopFill.scaleX=c,this.smokeTimer+=t,this.smokeTimer>=this.smokeInterval&&this.nearbyOven){this.smokeTimer=0;var a=this.nearbyOven.getChildByName("oven_point");if(a){var p=cc.instantiate(this.smokeEffectPrefab);p.name="SmokeEffect";var l=a.convertToWorldSpaceAR(cc.v3(0,0,-5)),h=this.nearbyOven.convertToNodeSpaceAR(l);p.setPosition(h),this.nearbyOven.addChild(p),console.log("\ud83d\udca8 \u70d8\u70e4\u4e2d\u5192\u7159\uff08\u4f86\u81ea oven_point\uff09")}else console.warn("\u26a0\ufe0f \u627e\u4e0d\u5230 oven_point\uff0c\u7121\u6cd5\u5192\u7159")}this.bakeProgress>=3&&this.finishBaking()}else this.isBaking&&!this.input.getChopPressed()&&(console.log("\ud83d\uded1 \u70d8\u70e4\u4e2d\u65b7\uff01"),this.cancelBaking());if(this.canDeliver&&this.input.getInteractPressed()&&this.carriedDough){var u=this.carriedDough.name,d=this.menuManager.slots.find(function(t){return t.children.length>0&&t.children[0].name===u});if(d){this.carriedDough.destroy(),this.carriedDough=null,d.removeAllChildren(),this.menuManager.addScore(50),this.showDeliveryEffect(),this.blingSound&&cc.audioEngine.playEffect(this.blingSound,!1);var f=this.uiManager.getComponent("MenuBar");f&&f.checkAndFillSlots(),console.log("\ud83c\udf89 \u6210\u529f\u51fa\u9910\uff1a"+u)}else console.warn("\u274c \u6b64\u62ab\u85a9\u4e0d\u5728\u83dc\u55ae\u4e0a\uff0c\u4e0d\u80fd\u51fa\u9910\uff01")}},e.prototype.spawnRunDust=function(){if(this.runDustEffectPrefab){var t=cc.instantiate(this.runDustEffectPrefab),e=this.node.getPosition();e.y-=40,t.setPosition(e),this.node.parent.addChild(t)}},e.prototype.isPizza=function(t){return["cheese_pizza","mushroom_pizza","pepper_pizza"].includes(t)},e.prototype.cancelBaking=function(){-1!==this.bakeSoundId&&(cc.audioEngine.stopEffect(this.bakeSoundId),this.bakeSoundId=-1),this.isBaking=!1,this.bakeProgress=0,this.smokeTimer=0,this.chopBar.active=!1,this.carriedDough&&(this.carriedDough.active=!0)},e.prototype.finishBaking=function(){if(-1!==this.bakeSoundId&&(cc.audioEngine.stopEffect(this.bakeSoundId),this.bakeSoundId=-1),this.isBaking=!1,this.chopBar.active=!1,this.bakeProgress=0,this.carriedDough){this.carriedDough.active=!0,this.carriedDough.baked=!0;var t=cc.instantiate(this.pizzaSteamPrefab);t.name="PizzaSteam",t.setPosition(cc.v3(0,40,0)),this.carriedDough.addChild(t),this.node.parent.children.forEach(function(t){"SmokeEffect"===t.name&&t.destroy()})}this.nearbyOven&&this.nearbyOven.children.forEach(function(t){"SmokeEffect"===t.name&&t.destroy()}),console.log("\u2705 "+this.carriedDough.name+" \u70d8\u70e4\u5b8c\u6210\uff01")},e.prototype.tryAssemblePizza=function(t){var e=t.children.map(function(t){return t.name}),o=e.includes("Flatbread"),n=e.includes("GratedCheese"),i=e.includes("SliceMushroom"),r=e.includes("SlicePP");if(o){var c=null;if(!n||i||r)if(!i||n||r){if(!r||n||i)return;(c=cc.instantiate(this.pepperPizzaPrefab)).name="pepper_pizza"}else(c=cc.instantiate(this.mushroomPizzaPrefab)).name="mushroom_pizza";else(c=cc.instantiate(this.cheesePizzaPrefab)).name="cheese_pizza";t.children.forEach(function(t){["Flatbread","GratedCheese","SliceMushroom","SlicePP"].includes(t.name)&&t.destroy()}),t.addChild(c);var a=t.getChildByName("DropPoint");if(a){var s=a.convertToWorldSpaceAR(cc.v3(0,0,0)),p=t.convertToNodeSpaceAR(s);c.setPosition(p)}console.log("\ud83c\udf55 \u5408\u6210 "+c.name+" \u6210\u529f\uff01")}},e.prototype.cancelChopping=function(){this.isChopping=!1,this.chopBar.active=!1,this.chopProgress=0,this.chopFill.scaleX=0,console.log("\ud83d\uded1 \u73a9\u5bb6\u653e\u958b\u7a7a\u767d\u9375\uff0c\u4e2d\u65b7\u5207\u9eb5\uff01")},e.prototype.startChopping=function(){if(this.currentDropTarget&&8===this.currentDropTag){var t=this.currentDropTarget.children.some(function(t){return t.name.includes("Dough")}),e=this.currentDropTarget.children.some(function(t){return t.name.includes("Cheese")}),o=this.currentDropTarget.children.some(function(t){return"PP"===t.name}),n=this.currentDropTarget.children.some(function(t){return"Mushroom"===t.name});t||e||o||n?(this.isChopping=!0,this.chopProgress=0,this.chopBar.parent=this.node,this.chopBar.setPosition(cc.v2(0,80)),this.chopBar.active=!0,this.chopFill.scaleX=0,console.log("\ud83d\udd2a \u5728\u6b63\u78ba\u7827\u677f\u4e0a\u958b\u59cb\u5207\u9eb5\u5718\uff01")):cc.warn("\u26a0\ufe0f \u9019\u500b\u7827\u677f\u4e0a\u6c92\u6709\u9eb5\u5718\uff0c\u4e0d\u80fd\u5207\uff01")}else cc.warn("\u26a0\ufe0f \u53ea\u80fd\u5728\u7827\u677f\u4e0a\uff08tag = 8\uff09\u5207\u98df\u6750\uff01")},e.prototype.finishChopping=function(){for(var t=!1,e=!1,o=!1,n=!1,i=0,r=this.currentDropTarget.children;i<r.length;i++){var c=r[i];"Dough"===c.name?(c.destroy(),e=!0):"Cheese"===c.name?(c.destroy(),t=!0):"PP"===c.name?(c.destroy(),o=!0):"Mushroom"===c.name&&(c.destroy(),n=!0)}var a=null;if(e?(a=cc.instantiate(this.flatbreadPrefa)).name="Flatbread":t?(a=cc.instantiate(this.gratedCheesePrefab)).name="GratedCheese":o?(a=cc.instantiate(this.sliceppPrefab)).name="SlicePP":n&&((a=cc.instantiate(this.slicemushroomPrefab)).name="SliceMushroom"),a){this.currentDropTarget.addChild(a);var s=this.currentDropTarget.getChildByName("DropPoint");if(!s)return void cc.warn("\u26a0\ufe0f \u627e\u4e0d\u5230 DropPoint\uff0c\u7121\u6cd5\u653e\u7f6e\u5207\u5b8c\u7684\u7269\u54c1\uff01");var p=s.convertToWorldSpaceAR(cc.v3(0,0,0)),l=this.currentDropTarget.convertToNodeSpaceAR(p);a.setPosition(l),console.log("\u2705 \u5207\u5b8c "+a.name+"\uff0c\u653e\u7f6e\u6210\u529f\uff01")}},e.prototype.tryInteract=function(){var t=this;if(this.canPickMushroom&&!this.carriedDough){var e=cc.instantiate(this.mushroomPrefab);this.node.addChild(e),e.name="Mushroom",e.setPosition(cc.v2(0,50)),this.carriedDough=e,this.pickupSound&&cc.audioEngine.playEffect(this.pickupSound,!1),console.log("\ud83c\udf44 \u62ff\u8d77\u8611\u83c7")}if(this.canPickPP&&!this.carriedDough){var o=cc.instantiate(this.ppPrefab);this.node.addChild(o),o.name="PP",o.setPosition(cc.v2(0,50)),this.carriedDough=o,this.pickupSound&&cc.audioEngine.playEffect(this.pickupSound,!1),console.log("\ud83c\udf45 \u62ff\u8d77\u756a\u8304")}if(this.canPickCheese&&!this.carriedDough){var n=cc.instantiate(this.cheesePrefab);this.node.addChild(n),n.name="Cheese",n.setPosition(cc.v2(0,50)),this.carriedDough=n,this.pickupSound&&cc.audioEngine.playEffect(this.pickupSound,!1),console.log("\ud83e\uddc0 \u62ff\u8d77\u8d77\u53f8")}if(this.canPickDough&&!this.carriedDough){var i=cc.instantiate(this.doughPrefab);this.node.addChild(i),i.name="Dough",i.setPosition(cc.v2(0,50)),this.carriedDough=i,this.pickupSound&&cc.audioEngine.playEffect(this.pickupSound,!1),console.log("\ud83c\udf92 \u62ff\u8d77\u9eb5\u5718")}else if(!this.carriedDough&&this.currentDropTarget){var r=this.currentDropTarget.children.find(function(t){return["Dough","Flatbread","Cheese","GratedCheese","Tomato","PizzaSauce","PP","SlicePP","Mushroom","SliceMushroom","cheese_pizza","mushroom_pizza","pepper_pizza"].some(function(e){return t.name.startsWith(e)})});r&&(this.carriedDough=r,r.removeFromParent(),this.node.addChild(r),r.setPosition(cc.v2(0,50)),this.pickupSound&&cc.audioEngine.playEffect(this.pickupSound,!1),console.log("\ud83c\udf92 \u64bf\u8d77\u684c\u4e0a\u7684\u7269\u54c1\uff1a"+r.name))}else if(this.canDropDough&&this.carriedDough&&this.currentDropTarget){var c=this.currentDropTarget.getChildByName("DropPoint");if(!c)return void cc.warn("\u274c \u627e\u4e0d\u5230 DropPoint\uff0c\u7121\u6cd5\u653e\u7f6e\uff01");this.currentDropTarget.children.some(function(t){return t!==c&&"Flatbread"!==t.name&&["Dough","Flatbread","Cheese","GratedCheese","Tomato","PizzaSauce","PP","SlicePP","Mushroom","SliceMushroom","cheese_pizza","mushroom_pizza","pepper_pizza"].some(function(e){return t.name&&t.name.startsWith(e)})});var a=this.currentDropTarget.children.some(function(t){return"Flatbread"===t.name}),s=this.currentDropTarget.children.some(function(e){return e!==c&&e.name===t.carriedDough.name});if(!a&&s)return void cc.warn("\u26a0\ufe0f \u7121\u6cd5\u653e\u7f6e\uff0c\u684c\u4e0a\u5df2\u6709\u76f8\u540c\u98df\u6750\uff01");this.carriedDough.parent=this.currentDropTarget;var p=c.convertToWorldSpaceAR(cc.v3(0,0,0)),l=this.currentDropTarget.convertToNodeSpaceAR(p);this.carriedDough.setPosition(l),console.log("\u2705 \u653e\u4e0b\u7269\u54c1\u5230 DropPoint\uff1a"+this.carriedDough.name),this.carriedDough=null,this.pickupSound&&cc.audioEngine.playEffect(this.pickupSound,!1),this.tryAssemblePizza(this.currentDropTarget)}},e.prototype.showDeliveryEffect=function(){var t=cc.instantiate(this.tipsLabelPrefab);t.setPosition(this.node.getPosition().add(cc.v2(0,100))),this.node.parent.addChild(t),cc.tween(t).by(1,{position:cc.v3(0,60,0),opacity:-255},{easing:"cubicOut"}).call(function(){return t.destroy()}).start();var e=cc.instantiate(this.tipsParticlePrefab);e.setPosition(this.node.getPosition()),this.node.parent.addChild(e)},e.prototype.playAnim=function(t){this.currentAnim!==t&&(this.currentAnim=t,this.anim.play(t))},e.prototype.onBeginContact=function(t,e,o){3===o.tag?this.canPickDough=!0:4===o.tag?(this.canPickCheese=!0,console.log("\ud83e\uddc0 \u53ef\u4ee5\u64bf\u8d77\u8d77\u53f8")):5===o.tag?(this.canPickPP=!0,console.log("\ud83c\udf45 \u53ef\u4ee5\u64bf\u8d77\u756a\u8304\uff01")):6===o.tag?(this.canPickMushroom=!0,console.log("\ud83c\udf44 \u53ef\u4ee5\u64bf\u8d77\u8611\u83c7\uff01")):8===o.tag||10===o.tag?(this.canDropDough=!0,this.currentDropTag=o.tag,this.currentDropTarget=o.node,console.log("\ud83e\udd63 \u63a5\u89f8\u5230\u7827\u677f Tag =",o.tag)):11===o.tag?(this.canDropDough=!0,this.currentDropTag=11,this.currentDropTarget=o.node):12===o.tag?(this.isNearOven=!0,this.nearbyOven=o.node,console.log("\ud83d\udd25 \u63a5\u89f8\u5230\u70e4\u7bb1\uff01")):9===o.tag&&(this.canDeliver=!0)},e.prototype.onEndContact=function(t,e,o){3===o.tag?this.canPickDough=!1:4===o.tag?this.canPickCheese=!1:5===o.tag?this.canPickPP=!1:6===o.tag?(this.canPickMushroom=!1,console.log("\ud83c\udf44 \u53ef\u4ee5\u64bf\u8d77\u8611\u83c7\uff01")):8===o.tag||10===o.tag||11===o.tag?(this.canDropDough=!1,this.currentDropTarget=null,this.currentDropTag=null):12===o.tag?(this.isNearOven=!1,this.bakeProgress=0,this.isBaking=!1,this.nearbyOven=null,this.chopBar.active=!1,-1!==this.bakeSoundId&&(cc.audioEngine.stopEffect(this.bakeSoundId),this.bakeSoundId=-1)):9===o.tag&&(this.canDeliver=!1)},r([h(cc.Animation)],e.prototype,"anim",void 0),r([h],e.prototype,"speed",void 0),r([h(cc.Prefab)],e.prototype,"doughPrefab",void 0),r([h(cc.Prefab)],e.prototype,"flatbreadPrefa",void 0),r([h(cc.Prefab)],e.prototype,"chopBarPrefab",void 0),r([h(cc.Prefab)],e.prototype,"cheesePrefab",void 0),r([h(cc.Prefab)],e.prototype,"gratedCheesePrefab",void 0),r([h(cc.Prefab)],e.prototype,"ppPrefab",void 0),r([h(cc.Prefab)],e.prototype,"sliceppPrefab",void 0),r([h(cc.Prefab)],e.prototype,"mushroomPrefab",void 0),r([h(cc.Prefab)],e.prototype,"slicemushroomPrefab",void 0),r([h(cc.Prefab)],e.prototype,"cheesePizzaPrefab",void 0),r([h(cc.Prefab)],e.prototype,"mushroomPizzaPrefab",void 0),r([h(cc.Prefab)],e.prototype,"pepperPizzaPrefab",void 0),r([h(cc.Prefab)],e.prototype,"smokeEffectPrefab",void 0),r([h(cc.Node)],e.prototype,"smokePoint",void 0),r([h(cc.Prefab)],e.prototype,"tipsLabelPrefab",void 0),r([h(cc.Prefab)],e.prototype,"tipsParticlePrefab",void 0),r([h(cc.Prefab)],e.prototype,"pizzaSteamPrefab",void 0),r([h(cc.Node)],e.prototype,"uiManager",void 0),r([h({type:cc.AudioClip})],e.prototype,"chopSound",void 0),r([h({type:cc.AudioClip})],e.prototype,"bakeSound",void 0),r([h(cc.Prefab)],e.prototype,"runDustEffectPrefab",void 0),r([h({type:cc.AudioClip})],e.prototype,"blingSound",void 0),r([h({type:cc.AudioClip})],e.prototype,"pickupSound",void 0),r([h({type:cc.AudioClip})],e.prototype,"placeSound",void 0),r([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../script/PlayerAnimationController":"PlayerAnimationController","../script/PlayerModeSelector":"PlayerModeSelector","./KeyboardControls2":"KeyboardControls2"}],PlayerController:[function(t,e,o){"use strict";cc._RF.push(e,"49d73Terv9CSKbbSOPEQgbT","PlayerController");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./KeyboardControls"),a=t("../script/PlayerAnimationController"),s=cc._decorator,p=s.ccclass,l=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anim=null,e.speed=200,e.doughPrefab=null,e.flatbreadPrefa=null,e.chopBarPrefab=null,e.cheesePrefab=null,e.gratedCheesePrefab=null,e.ppPrefab=null,e.sliceppPrefab=null,e.mushroomPrefab=null,e.slicemushroomPrefab=null,e.cheesePizzaPrefab=null,e.mushroomPizzaPrefab=null,e.pepperPizzaPrefab=null,e.smokeEffectPrefab=null,e.smokePoint=null,e.tipsLabelPrefab=null,e.tipsParticlePrefab=null,e.pizzaSteamPrefab=null,e.uiManager=null,e.chopSound=null,e.chopSoundTimer=0,e.isRunning=!1,e.runMultiplier=1.3,e.runDustEffectPrefab=null,e.runDustTimer=0,e.runDustInterval=.2,e.blingSound=null,e.pickupSound=null,e.placeSound=null,e.bakeSound=null,e.bakeSoundId=-1,e.canDeliver=!1,e.menuManager=null,e.nearbyOven=null,e.smokeTimer=0,e.smokeInterval=.5,e.input=null,e.currentAnim="",e.lastDir=cc.v2(0,-1),e.rb=null,e.canPickDough=!1,e.canDropDough=!1,e.carriedDough=null,e.currentDropTarget=null,e.currentDropTag=null,e.isChopping=!1,e.chopProgress=0,e.chopFill=null,e.chopBar=null,e.canPickCheese=!1,e.canPickPP=!1,e.canPickMushroom=!1,e.isBaking=!1,e.bakeProgress=0,e.isNearOven=!1,e.lastInteractTime=0,e.interactCooldown=.2,e}return i(e,t),e.prototype.start=function(){var t,e=this.getComponent(cc.PhysicsBoxCollider);if(e&&(e.enabled=!0,e.apply()),this.anim||(this.anim=this.getComponent(cc.Animation)),this.rb=this.getComponent(cc.RigidBody),this.rb){var o=0===a.default.player1CharIndex?"girl":"girl2";this.playAnim(o+"_idle_back"),this.input=new c.KeyboardControls,console.log("\u2328\ufe0f \u4f7f\u7528 KeyboardControls\uff01");var n=cc.instantiate(this.chopBarPrefab);this.node.addChild(n),n.setPosition(cc.v2(0,80)),this.chopBar=n,this.chopFill=n.getChildByName("Fillbar"),this.chopFill||cc.error("\u274c \u627e\u4e0d\u5230 Fillbar\uff01"),n.active=!1,this.menuManager=null===(t=this.uiManager)||void 0===t?void 0:t.getComponent("MenuBar")}else cc.error("\u274c \u627e\u4e0d\u5230 RigidBody2D \u7d44\u4ef6\uff01")},e.prototype.update=function(t){var e=this.input.getMoveDirection();if(e.equals(cc.Vec2.ZERO)?this.rb.linearVelocity=cc.Vec2.ZERO:this.rb.linearVelocity=e.normalize().mul(this.speed),console.log("\ud83d\udce6 \u63a7\u5236\u5668\u8f38\u51fa\u7684\u65b9\u5411\u662f\uff1ax="+e.x+", y="+e.y),this.isRunning=this.input.getRunHeld(),e.equals(cc.Vec2.ZERO))this.rb.linearVelocity=cc.v2(0,0),n=0===a.default.player1CharIndex?"girl":"girl2",Math.abs(this.lastDir.y)>Math.abs(this.lastDir.x)?this.playAnim(this.lastDir.y>0?n+"_idle_back":n+"_idle"):this.playAnim(this.lastDir.x>0?n+"_idle_right":n+"_idle_left"),this.node.scaleX=1;else{this.isRunning?(this.rb.linearVelocity=e.clone().normalize().mul(this.speed*this.runMultiplier),this.runDustTimer+=t,this.runDustTimer>=this.runDustInterval&&(this.runDustTimer=0,this.spawnRunDust())):(this.rb.linearVelocity=e.clone().normalize().mul(this.speed),this.runDustTimer=0);var o=this.speed;this.isRunning&&(o*=this.runMultiplier),this.rb.linearVelocity=e.clone().normalize().mul(o),this.lastDir=e.clone();var n=0===a.default.player1CharIndex?"girl":"girl2";Math.abs(e.y)>Math.abs(e.x)?(e.y>0?this.playAnim(this.isRunning?n+"_run_back":n+"_walk_back"):this.playAnim(this.isRunning?n+"_run":n+"_walk"),this.node.scaleX=1):e.x>0?(this.playAnim(this.isRunning?n+"_run_right":n+"_walk_right"),this.node.scaleX=1):(this.playAnim(this.isRunning?n+"_run_left":n+"_walk_left"),this.node.scaleX=1)}if(this.input.getInteractPressed()){var i=Date.now()/1e3;i-this.lastInteractTime>this.interactCooldown&&(this.tryInteract(),this.lastInteractTime=i)}if(this.input.getChopPressed()&&this.canDropDough&&null==this.carriedDough&&!this.isChopping&&this.startChopping(),this.isChopping)if(this.input.getChopPressed()){this.chopProgress+=t;var r=Math.min(this.chopProgress/2,1);this.chopFill.scaleX=r,this.chopSoundTimer+=t,this.chopSoundTimer>=.2&&(this.chopSoundTimer=0,this.chopSound&&cc.audioEngine.playEffect(this.chopSound,!1)),this.chopProgress>=2&&this.finishChopping()}else this.cancelChopping();else this.chopSoundTimer=0;if(this.input.getChopPressed()&&this.isNearOven&&this.carriedDough&&this.isPizza(this.carriedDough.name)&&!this.carriedDough.baked&&!this.isBaking&&(this.isBaking=!0,this.bakeSound&&-1===this.bakeSoundId&&(this.bakeSoundId=cc.audioEngine.playEffect(this.bakeSound,!0)),this.bakeProgress=0,this.carriedDough.active=!1,this.chopBar.parent=this.node,this.chopBar.setPosition(cc.v2(0,80)),this.chopBar.active=!0,this.chopFill.scaleX=0,console.log("\ud83d\udd25 \u62ab\u85a9\u653e\u5165\u70e4\u7bb1\u4e2d...")),this.input.getChopPressed()&&this.isNearOven&&this.carriedDough&&this.isPizza(this.carriedDough.name)&&this.carriedDough.baked&&console.warn("\u26a0\ufe0f \u9019\u584a\u62ab\u85a9\u5df2\u7d93\u70e4\u904e\u4e86\uff0c\u4e0d\u80fd\u91cd\u8907\u70d8\u70e4\uff01"),this.isBaking&&this.input.getChopPressed()){this.bakeProgress+=t;var c=Math.min(this.bakeProgress/3,1);if(this.chopFill.scaleX=c,this.smokeTimer+=t,this.smokeTimer>=this.smokeInterval&&this.nearbyOven){this.smokeTimer=0;var s=this.nearbyOven.getChildByName("oven_point");if(s){var p=cc.instantiate(this.smokeEffectPrefab);p.name="SmokeEffect";var l=s.convertToWorldSpaceAR(cc.v3(0,0,-5)),h=this.nearbyOven.convertToNodeSpaceAR(l);p.setPosition(h),this.nearbyOven.addChild(p),console.log("\ud83d\udca8 \u70d8\u70e4\u4e2d\u5192\u7159\uff08\u4f86\u81ea oven_point\uff09")}else console.warn("\u26a0\ufe0f \u627e\u4e0d\u5230 oven_point\uff0c\u7121\u6cd5\u5192\u7159")}this.bakeProgress>=3&&this.finishBaking()}else this.isBaking&&!this.input.getChopPressed()&&(console.log("\ud83d\uded1 \u70d8\u70e4\u4e2d\u65b7\uff01"),this.cancelBaking());if(this.canDeliver&&this.input.getInteractPressed()&&this.carriedDough){var u=this.carriedDough.name,d=this.menuManager.slots.find(function(t){return t.children.length>0&&t.children[0].name===u});if(d){this.carriedDough.destroy(),this.carriedDough=null,d.removeAllChildren(),this.menuManager.addScore(50),this.showDeliveryEffect(),this.blingSound&&cc.audioEngine.playEffect(this.blingSound,!1);var f=this.uiManager.getComponent("MenuBar");f&&f.checkAndFillSlots(),console.log("\ud83c\udf89 \u6210\u529f\u51fa\u9910\uff1a"+u)}else console.warn("\u274c \u6b64\u62ab\u85a9\u4e0d\u5728\u83dc\u55ae\u4e0a\uff0c\u4e0d\u80fd\u51fa\u9910\uff01")}},e.prototype.spawnRunDust=function(){if(this.runDustEffectPrefab){var t=cc.instantiate(this.runDustEffectPrefab),e=this.node.getPosition();e.y-=40,t.setPosition(e),this.node.parent.addChild(t)}},e.prototype.isPizza=function(t){return["cheese_pizza","mushroom_pizza","pepper_pizza"].includes(t)},e.prototype.cancelBaking=function(){-1!==this.bakeSoundId&&(cc.audioEngine.stopEffect(this.bakeSoundId),this.bakeSoundId=-1),this.isBaking=!1,this.bakeProgress=0,this.smokeTimer=0,this.chopBar.active=!1,this.carriedDough&&(this.carriedDough.active=!0)},e.prototype.finishBaking=function(){if(-1!==this.bakeSoundId&&(cc.audioEngine.stopEffect(this.bakeSoundId),this.bakeSoundId=-1),this.isBaking=!1,this.chopBar.active=!1,this.bakeProgress=0,this.carriedDough){this.carriedDough.active=!0,this.carriedDough.baked=!0;var t=cc.instantiate(this.pizzaSteamPrefab);t.name="PizzaSteam",t.setPosition(cc.v3(0,40,0)),this.carriedDough.addChild(t),this.node.parent.children.forEach(function(t){"SmokeEffect"===t.name&&t.destroy()})}this.nearbyOven&&this.nearbyOven.children.forEach(function(t){"SmokeEffect"===t.name&&t.destroy()}),console.log("\u2705 "+this.carriedDough.name+" \u70d8\u70e4\u5b8c\u6210\uff01")},e.prototype.tryAssemblePizza=function(t){var e=t.children.map(function(t){return t.name}),o=e.includes("Flatbread"),n=e.includes("GratedCheese"),i=e.includes("SliceMushroom"),r=e.includes("SlicePP");if(o){var c=null;if(!n||i||r)if(!i||n||r){if(!r||n||i)return;(c=cc.instantiate(this.pepperPizzaPrefab)).name="pepper_pizza"}else(c=cc.instantiate(this.mushroomPizzaPrefab)).name="mushroom_pizza";else(c=cc.instantiate(this.cheesePizzaPrefab)).name="cheese_pizza";t.children.forEach(function(t){["Flatbread","GratedCheese","SliceMushroom","SlicePP"].includes(t.name)&&t.destroy()}),t.addChild(c);var a=t.getChildByName("DropPoint");if(a){var s=a.convertToWorldSpaceAR(cc.v3(0,0,0)),p=t.convertToNodeSpaceAR(s);c.setPosition(p)}console.log("\ud83c\udf55 \u5408\u6210 "+c.name+" \u6210\u529f\uff01")}},e.prototype.cancelChopping=function(){this.isChopping=!1,this.chopBar.active=!1,this.chopProgress=0,this.chopFill.scaleX=0,console.log("\ud83d\uded1 \u73a9\u5bb6\u653e\u958b\u7a7a\u767d\u9375\uff0c\u4e2d\u65b7\u5207\u9eb5\uff01")},e.prototype.startChopping=function(){if(this.currentDropTarget&&8===this.currentDropTag){var t=this.currentDropTarget.children.some(function(t){return t.name.includes("Dough")}),e=this.currentDropTarget.children.some(function(t){return t.name.includes("Cheese")}),o=this.currentDropTarget.children.some(function(t){return"PP"===t.name}),n=this.currentDropTarget.children.some(function(t){return"Mushroom"===t.name});t||e||o||n?(this.isChopping=!0,this.chopProgress=0,this.chopBar.parent=this.node,this.chopBar.setPosition(cc.v2(0,80)),this.chopBar.active=!0,this.chopFill.scaleX=0,console.log("\ud83d\udd2a \u5728\u6b63\u78ba\u7827\u677f\u4e0a\u958b\u59cb\u5207\u9eb5\u5718\uff01")):cc.warn("\u26a0\ufe0f \u9019\u500b\u7827\u677f\u4e0a\u6c92\u6709\u9eb5\u5718\uff0c\u4e0d\u80fd\u5207\uff01")}else cc.warn("\u26a0\ufe0f \u53ea\u80fd\u5728\u7827\u677f\u4e0a\uff08tag = 8\uff09\u5207\u98df\u6750\uff01")},e.prototype.finishChopping=function(){for(var t=!1,e=!1,o=!1,n=!1,i=0,r=this.currentDropTarget.children;i<r.length;i++){var c=r[i];"Dough"===c.name?(c.destroy(),e=!0):"Cheese"===c.name?(c.destroy(),t=!0):"PP"===c.name?(c.destroy(),o=!0):"Mushroom"===c.name&&(c.destroy(),n=!0)}var a=null;if(e?(a=cc.instantiate(this.flatbreadPrefa)).name="Flatbread":t?(a=cc.instantiate(this.gratedCheesePrefab)).name="GratedCheese":o?(a=cc.instantiate(this.sliceppPrefab)).name="SlicePP":n&&((a=cc.instantiate(this.slicemushroomPrefab)).name="SliceMushroom"),a){this.currentDropTarget.addChild(a);var s=this.currentDropTarget.getChildByName("DropPoint");if(!s)return void cc.warn("\u26a0\ufe0f \u627e\u4e0d\u5230 DropPoint\uff0c\u7121\u6cd5\u653e\u7f6e\u5207\u5b8c\u7684\u7269\u54c1\uff01");var p=s.convertToWorldSpaceAR(cc.v3(0,0,0)),l=this.currentDropTarget.convertToNodeSpaceAR(p);a.setPosition(l),console.log("\u2705 \u5207\u5b8c "+a.name+"\uff0c\u653e\u7f6e\u6210\u529f\uff01")}},e.prototype.tryInteract=function(){var t=this;if(this.canPickMushroom&&!this.carriedDough){var e=cc.instantiate(this.mushroomPrefab);this.node.addChild(e),e.name="Mushroom",e.setPosition(cc.v2(0,50)),this.carriedDough=e,this.pickupSound&&cc.audioEngine.playEffect(this.pickupSound,!1),console.log("\ud83c\udf44 \u62ff\u8d77\u8611\u83c7")}if(this.canPickPP&&!this.carriedDough){var o=cc.instantiate(this.ppPrefab);this.node.addChild(o),o.name="PP",o.setPosition(cc.v2(0,50)),this.carriedDough=o,this.pickupSound&&cc.audioEngine.playEffect(this.pickupSound,!1),console.log("\ud83c\udf45 \u62ff\u8d77\u756a\u8304")}if(this.canPickCheese&&!this.carriedDough){var n=cc.instantiate(this.cheesePrefab);this.node.addChild(n),n.name="Cheese",n.setPosition(cc.v2(0,50)),this.carriedDough=n,this.pickupSound&&cc.audioEngine.playEffect(this.pickupSound,!1),console.log("\ud83e\uddc0 \u62ff\u8d77\u8d77\u53f8")}if(this.canPickDough&&!this.carriedDough){var i=cc.instantiate(this.doughPrefab);this.node.addChild(i),i.name="Dough",i.setPosition(cc.v2(0,50)),this.carriedDough=i,this.pickupSound&&cc.audioEngine.playEffect(this.pickupSound,!1),console.log("\ud83c\udf92 \u62ff\u8d77\u9eb5\u5718")}else if(!this.carriedDough&&this.currentDropTarget){var r=this.currentDropTarget.children.find(function(t){return["Dough","Flatbread","Cheese","GratedCheese","Tomato","PizzaSauce","PP","SlicePP","Mushroom","SliceMushroom","cheese_pizza","mushroom_pizza","pepper_pizza"].some(function(e){return t.name.startsWith(e)})});r&&(this.carriedDough=r,r.removeFromParent(),this.node.addChild(r),r.setPosition(cc.v2(0,50)),this.pickupSound&&cc.audioEngine.playEffect(this.pickupSound,!1),console.log("\ud83c\udf92 \u64bf\u8d77\u684c\u4e0a\u7684\u7269\u54c1\uff1a"+r.name))}else if(this.canDropDough&&this.carriedDough&&this.currentDropTarget){var c=this.currentDropTarget.getChildByName("DropPoint");if(!c)return void cc.warn("\u274c \u627e\u4e0d\u5230 DropPoint\uff0c\u7121\u6cd5\u653e\u7f6e\uff01");this.currentDropTarget.children.some(function(t){return t!==c&&"Flatbread"!==t.name&&["Dough","Flatbread","Cheese","GratedCheese","Tomato","PizzaSauce","PP","SlicePP","Mushroom","SliceMushroom","cheese_pizza","mushroom_pizza","pepper_pizza"].some(function(e){return t.name&&t.name.startsWith(e)})});var a=this.currentDropTarget.children.some(function(t){return"Flatbread"===t.name}),s=this.currentDropTarget.children.some(function(e){return e!==c&&e.name===t.carriedDough.name});if(!a&&s)return void cc.warn("\u26a0\ufe0f \u7121\u6cd5\u653e\u7f6e\uff0c\u684c\u4e0a\u5df2\u6709\u76f8\u540c\u98df\u6750\uff01");this.carriedDough.parent=this.currentDropTarget;var p=c.convertToWorldSpaceAR(cc.v3(0,0,0)),l=this.currentDropTarget.convertToNodeSpaceAR(p);this.carriedDough.setPosition(l),console.log("\u2705 \u653e\u4e0b\u7269\u54c1\u5230 DropPoint\uff1a"+this.carriedDough.name),this.carriedDough=null,this.pickupSound&&cc.audioEngine.playEffect(this.pickupSound,!1),this.tryAssemblePizza(this.currentDropTarget)}},e.prototype.showDeliveryEffect=function(){var t=cc.instantiate(this.tipsLabelPrefab);t.setPosition(this.node.getPosition().add(cc.v2(0,100))),this.node.parent.addChild(t),cc.tween(t).by(1,{position:cc.v3(0,60,0),opacity:-255},{easing:"cubicOut"}).call(function(){return t.destroy()}).start();var e=cc.instantiate(this.tipsParticlePrefab);e.setPosition(this.node.getPosition()),this.node.parent.addChild(e)},e.prototype.playAnim=function(t){this.currentAnim!==t&&(this.currentAnim=t,this.anim.play(t))},e.prototype.onBeginContact=function(t,e,o){3===o.tag?this.canPickDough=!0:4===o.tag?(this.canPickCheese=!0,console.log("\ud83e\uddc0 \u53ef\u4ee5\u64bf\u8d77\u8d77\u53f8")):5===o.tag?(this.canPickPP=!0,console.log("\ud83c\udf45 \u53ef\u4ee5\u64bf\u8d77\u756a\u8304\uff01")):6===o.tag?(this.canPickMushroom=!0,console.log("\ud83c\udf44 \u53ef\u4ee5\u64bf\u8d77\u8611\u83c7\uff01")):8===o.tag||10===o.tag?(this.canDropDough=!0,this.currentDropTag=o.tag,this.currentDropTarget=o.node,console.log("\ud83e\udd63 \u63a5\u89f8\u5230\u7827\u677f Tag =",o.tag)):11===o.tag?(this.canDropDough=!0,this.currentDropTag=11,this.currentDropTarget=o.node):12===o.tag?(this.isNearOven=!0,this.nearbyOven=o.node,console.log("\ud83d\udd25 \u63a5\u89f8\u5230\u70e4\u7bb1\uff01"),-1!==this.bakeSoundId&&(cc.audioEngine.stopEffect(this.bakeSoundId),this.bakeSoundId=-1)):9===o.tag&&(this.canDeliver=!0)},e.prototype.onEndContact=function(t,e,o){3===o.tag?this.canPickDough=!1:4===o.tag?this.canPickCheese=!1:5===o.tag?this.canPickPP=!1:6===o.tag?(this.canPickMushroom=!1,console.log("\ud83c\udf44 \u53ef\u4ee5\u64bf\u8d77\u8611\u83c7\uff01")):8===o.tag||10===o.tag||11===o.tag?(this.canDropDough=!1,this.currentDropTarget=null,this.currentDropTag=null):12===o.tag?(this.isNearOven=!1,this.bakeProgress=0,this.isBaking=!1,this.nearbyOven=null,this.chopBar.active=!1):9===o.tag&&(this.canDeliver=!1)},e.player1CharIndex=0,r([l(cc.Animation)],e.prototype,"anim",void 0),r([l],e.prototype,"speed",void 0),r([l(cc.Prefab)],e.prototype,"doughPrefab",void 0),r([l(cc.Prefab)],e.prototype,"flatbreadPrefa",void 0),r([l(cc.Prefab)],e.prototype,"chopBarPrefab",void 0),r([l(cc.Prefab)],e.prototype,"cheesePrefab",void 0),r([l(cc.Prefab)],e.prototype,"gratedCheesePrefab",void 0),r([l(cc.Prefab)],e.prototype,"ppPrefab",void 0),r([l(cc.Prefab)],e.prototype,"sliceppPrefab",void 0),r([l(cc.Prefab)],e.prototype,"mushroomPrefab",void 0),r([l(cc.Prefab)],e.prototype,"slicemushroomPrefab",void 0),r([l(cc.Prefab)],e.prototype,"cheesePizzaPrefab",void 0),r([l(cc.Prefab)],e.prototype,"mushroomPizzaPrefab",void 0),r([l(cc.Prefab)],e.prototype,"pepperPizzaPrefab",void 0),r([l(cc.Prefab)],e.prototype,"smokeEffectPrefab",void 0),r([l(cc.Node)],e.prototype,"smokePoint",void 0),r([l(cc.Prefab)],e.prototype,"tipsLabelPrefab",void 0),r([l(cc.Prefab)],e.prototype,"tipsParticlePrefab",void 0),r([l(cc.Prefab)],e.prototype,"pizzaSteamPrefab",void 0),r([l(cc.Node)],e.prototype,"uiManager",void 0),r([l({type:cc.AudioClip})],e.prototype,"chopSound",void 0),r([l(cc.Prefab)],e.prototype,"runDustEffectPrefab",void 0),r([l({type:cc.AudioClip})],e.prototype,"blingSound",void 0),r([l({type:cc.AudioClip})],e.prototype,"pickupSound",void 0),r([l({type:cc.AudioClip})],e.prototype,"placeSound",void 0),r([l({type:cc.AudioClip})],e.prototype,"bakeSound",void 0),r([p],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../script/PlayerAnimationController":"PlayerAnimationController","./KeyboardControls":"KeyboardControls"}],PlayerModeSelector:[function(t,e,o){"use strict";cc._RF.push(e,"aefe3x7WwFOkYl5ZGP0jnzm","PlayerModeSelector");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.player=null,e.char_select=null,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){o.player_mode=0,this.player.active=!1,this.char_select.active=!1},e.prototype.onToggleGroupChanged=function(){0===this.node.getComponentsInChildren(cc.Toggle).findIndex(function(t){return t.isChecked})?(o.player_mode=0,console.log("\u9078\u64c7\u4e86\u55ae\u4eba\u6a21\u5f0f"),this.player.active=!1,this.char_select.active=!1):(o.player_mode=1,this.player.active=!0,this.char_select.active=!0,console.log("PlayerModeSelector.player_mode = 0")),cc.log("player_mode:",o.player_mode)},e.player_mode=0,r([s(cc.Node)],e.prototype,"player",void 0),r([s(cc.Node)],e.prototype,"char_select",void 0),o=r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],PlayerModeWatcher:[function(t,e,o){"use strict";cc._RF.push(e,"1e36eDJejpBEKpG1o5PIgVg","PlayerModeWatcher");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./PlayerModeSelector"),a=cc._decorator,s=a.ccclass,p=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.update=function(){this.node.active=0===c.default.player_mode},r([s],e)}(cc.Component));o.default=p,cc._RF.pop()},{"./PlayerModeSelector":"PlayerModeSelector"}],PositionManager:[function(t,e,o){"use strict";cc._RF.push(e,"fb83cLzGUdGM5GpNKBYAtWQ","PositionManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.savePosition=function(t){this.savedPos=t.clone()},t.getSavedPosition=function(){return this.savedPos},t.clear=function(){this.savedPos=null},t.savedPos=null,t}();o.default=n,cc._RF.pop()},{}],ScorePersist:[function(t,e,o){"use strict";cc._RF.push(e,"72632a25jtMR4xv91HIBR4O","ScorePersist");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.score=0,e.fromScene="",e}return i(e,t),e.prototype.onLoad=function(){cc.game.addPersistRootNode(this.node)},r([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],ShowImageOnPlane:[function(t,e,o){"use strict";cc._RF.push(e,"f5fb8gzmbZFAIkc+ZmPjljF","ShowImageOnPlane");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.texture=null,e}return i(e,t),e.prototype.start=function(){var t=this;this.texture?this.applyTexture(this.texture):cc.loader.loadRes("background/brickWall",cc.Texture2D,function(e,o){e?cc.error("\u8f09\u5165\u5716\u7247\u5931\u6557",e):t.applyTexture(o)})},e.prototype.applyTexture=function(t){var e=this.node.getComponent(cc.MeshRenderer);if(e){var o=e.getMaterial(0);o?(o.setProperty("texture",t),e.setMaterial(0,o)):cc.error("MeshRenderer \u6c92\u6709\u6750\u8cea\uff01")}else cc.error("\u672c\u7bc0\u9ede\u6c92\u6709 MeshRenderer \u7d44\u4ef6\uff01")},r([s({type:cc.Texture2D})],e.prototype,"texture",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],Signup:[function(t,e,o){"use strict";cc._RF.push(e,"4f89cT6uh1LY4cSDkbEcqj7","Signup");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.firebaseManager=null,e}return i(e,t),e.prototype.start=function(){console.log("Signup component started");var t=new cc.Component.EventHandler;t.target=this.node,t.component="Signup",t.handler="onSignUp",cc.find("Canvas/Signup/Submit").getComponent(cc.Button).clickEvents.push(t)},e.prototype.onSignUp=function(){var t=this,e=cc.find("Canvas/Signup/Email").getComponent(cc.EditBox).string,o=cc.find("Canvas/Signup/Password").getComponent(cc.EditBox).string,n=cc.find("Canvas/Signup/Nickname").getComponent(cc.EditBox).string;console.log(e,o,n),e&&o&&n?this.firebaseManager.getAuth().createUserWithEmailAndPassword(e,o).then(function(o){var i=o.user.uid;return t.firebaseManager.getDatabase().ref("users/"+i).set({nickname:n,email:e}).then(function(){var t=cc.director.getScene().getChildByName("PersistentUser");t?t.getComponent("PersistentUser").setUserInfo(i,e,n):console.warn("\u627e\u4e0d\u5230 PersistentUser persist node\uff01")})}).then(function(){console.log("\u8a3b\u518a\u6210\u529f"),alert("\u8a3b\u518a\u6210\u529f"),cc.director.loadScene("Loading")}):alert("\u8acb\u586b\u5beb\u6240\u6709\u6b04\u4f4d")},e.prototype.getErrorMessage=function(t){switch(t){case"auth/invalid-email":return"\u7121\u6548\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740";case"auth/email-already-in-use":return"\u6b64\u96fb\u5b50\u90f5\u4ef6\u5df2\u88ab\u4f7f\u7528";case"auth/weak-password":return"\u5bc6\u78bc\u5f37\u5ea6\u592a\u5f31";default:return"\u8a3b\u518a\u5931\u6557\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66"}},r([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],cameraCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"2f5aaaZVYxLzIWb7asCBIU3","cameraCtrl");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.target=null,e.offset=new cc.Vec3(0,4,5),e.followSpeed=5,e}return i(e,t),e.prototype.start=function(){if(this.target){var t=this.target.convertToWorldSpaceAR(cc.Vec3.ZERO),e=new cc.Vec3;cc.Vec3.add(e,t,this.offset),this.node.position=this.node.parent?this.node.parent.convertToNodeSpaceAR(e):e,this.node.lookAt(t,cc.Vec3.UP)}else console.warn("There's no target node in cameraCtrl!")},e.prototype.update=function(t){if(this.target){var e=this.target.convertToWorldSpaceAR(cc.Vec3.ZERO),o=new cc.Vec3;cc.Vec3.add(o,e,this.offset);var n=this.node.convertToWorldSpaceAR(cc.Vec3.ZERO),i=new cc.Vec3;cc.Vec3.lerp(i,n,o,this.followSpeed*t),this.node.position=this.node.parent?this.node.parent.convertToNodeSpaceAR(i):i,this.node.lookAt(e,cc.Vec3.UP)}},r([s(cc.Node)],e.prototype,"target",void 0),r([s(cc.Vec3)],e.prototype,"offset",void 0),r([s(cc.Integer)],e.prototype,"followSpeed",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],debug:[function(t,e,o){"use strict";cc._RF.push(e,"c9b6fW5GdBHsbub2zcs1Nl7","debug");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onLoad=function(){cc.director.getPhysicsManager().enabled=!0},r([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],flagTrigger:[function(t,e,o){"use strict";cc._RF.push(e,"916fftxgi1HoLctc3cyvdGA","flagTrigger");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=t("./PositionManager"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vehicle=null,e.hintPrefab=null,e.hintOffset=cc.v3(.8,.1,0),e.triggerDistance=.7,e.nowIn=0,e.hintInstance=null,e.hintScript=null,e.inRange=!1,e.isLoadingScene=!1,e}return i(e,t),e.prototype.onLoad=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),this.hintPrefab&&(this.hintInstance=cc.instantiate(this.hintPrefab),this.node.addChild(this.hintInstance),this.hintInstance.setPosition(this.hintOffset),this.hintInstance.active=!1,this.hintInstance.scale=0,this.hintScript=this.hintInstance.getComponent("hintAnimation"),this.hintScript.setKeyScale(this.nowIn))},e.prototype.onDestroy=function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.update=function(){if(this.vehicle&&this.hintInstance&&this.hintScript){var t=this.node.getPosition(),e=this.vehicle.getPosition();t.subtract(e).mag()<this.triggerDistance?this.inRange||(this.hintInstance.active=!0,this.hintScript.playShow(),this.inRange=!0):this.inRange&&(this.hintScript.playHide(),this.inRange=!1)}},e.prototype.onKeyDown=function(t){var e=this;if(this.inRange&&t.keyCode===cc.macro.KEY.e){cc.log("key E pressed");var o=this.vehicle.convertToWorldSpaceAR(cc.Vec3.ZERO),n=this.node.parent.convertToNodeSpaceAR(o);if(p.default.savePosition(n.clone()),!this.isLoadingScene){this.isLoadingScene=!0;var i=cc.find("MainCamera/mask3D"),r=null==i?void 0:i.getComponent("maskTransition3D");if(!r)return void console.warn("\u26a0\ufe0f maskTransition script not found on mask3D node!");r.playTransition(function(){switch(e.nowIn){case 1:cc.director.loadScene("ice-cream-check");break;case 2:cc.director.loadScene("pizza-check");break;case 3:cc.director.loadScene("Menu");break;default:cc.director.loadScene("selectScene")}})}}},e.prototype.getNowIn=function(){return this.nowIn},r([s(cc.Node)],e.prototype,"vehicle",void 0),r([s(cc.Prefab)],e.prototype,"hintPrefab",void 0),r([s(cc.Vec3)],e.prototype,"hintOffset",void 0),r([s],e.prototype,"triggerDistance",void 0),r([s],e.prototype,"nowIn",void 0),r([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./PositionManager":"PositionManager"}],hintAnimation:[function(t,e,o){"use strict";cc._RF.push(e,"89633Yi0CZMZ69HmV5b2zmQ","hintAnimation");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stage=0,e.keyScale=.01,e}return i(e,t),e.prototype.onLoad=function(){this.node.scale=0,this.node.active=!1},e.prototype.playShow=function(){this.node.active=!0,cc.Tween.stopAllByTarget(this.node),this.node.scale=0,cc.tween(this.node).to(.2,{scale:this.keyScale},{easing:"backOut"}).start(),console.log("E show up!!")},e.prototype.playHide=function(){var t=this;cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.2,{scale:0},{easing:"backIn"}).call(function(){t.node.active=!1}).start()},e.prototype.setKeyScale=function(t){switch(this.stage=t,this.stage){case 1:this.keyScale=.01;break;case 2:this.keyScale=.0125;break;case 3:this.keyScale=.006;break;default:this.keyScale=.01}},r([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],icecreamCheck:[function(t,e,o){"use strict";cc._RF.push(e,"ff471ddThpIbaIeMmFb8m4E","icecreamCheck");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startButton=null,e.backButton=null,e.black=null,e.mask=null,e}return i(e,t),e.prototype.onLoad=function(){this.startButton&&this.startButton.node.on("click",this.onStartClick,this),this.backButton&&this.backButton.node.on("click",this.onBackClick,this)},e.prototype.start=function(){var t=this;this.black&&(this.black.node.active=!0,this.scheduleOnce(function(){t.black.node.active=!1},.5)),this.scheduleOnce(function(){t.mask&&(t.mask.node.active=!0,cc.tween(t.mask.node).to(.8,{position:cc.v3(91.285,-1255.166),scaleX:80,scaleY:80}).call(function(){t.mask.node.active=!1}).start())},.5)},e.prototype.onDestroy=function(){this.startButton&&this.startButton.node&&this.startButton.node.off("click",this.onStartClick,this),this.backButton&&this.backButton.node&&this.backButton.node.off("click",this.onBackClick,this)},e.prototype.onStartClick=function(){console.log("start-btn pressed\uff01"),cc.director.loadScene("level-2")},e.prototype.onBackClick=function(){console.log("back-btn pressed\uff01"),cc.director.loadScene("selectScene")},r([s(cc.Button)],e.prototype,"startButton",void 0),r([s(cc.Button)],e.prototype,"backButton",void 0),r([s(cc.Sprite)],e.prototype,"black",void 0),r([s(cc.Sprite)],e.prototype,"mask",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],maskTransition3D:[function(t,e,o){"use strict";cc._RF.push(e,"963b2io3I9NfaOldJtdCuQy","maskTransition3D");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startZ=0,e.endZ=-2.419,e}return i(e,t),e.prototype.onLoad=function(){this.node.setPosition(0,0,this.startZ)},e.prototype.playTransition=function(t){cc.tween(this.node).to(.8,{position:cc.v3(0,0,this.endZ)}).call(function(){t&&t()}).start()},r([s],e.prototype,"startZ",void 0),r([s],e.prototype,"endZ",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],pizzaCheck:[function(t,e,o){"use strict";cc._RF.push(e,"ffe13TzWdlKgaJEHUeYvP+7","pizzaCheck");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startButton=null,e.backButton=null,e.black=null,e.mask=null,e}return i(e,t),e.prototype.onLoad=function(){this.startButton&&this.startButton.node.on("click",this.onStartClick,this),this.backButton&&this.backButton.node.on("click",this.onBackClick,this)},e.prototype.start=function(){var t=this;this.black&&(this.black.node.active=!0,this.scheduleOnce(function(){t.black.node.active=!1},.5)),this.scheduleOnce(function(){t.mask&&(t.mask.node.active=!0,cc.tween(t.mask.node).to(.8,{position:cc.v3(91.285,-1255.166),scaleX:80,scaleY:80}).call(function(){t.mask.node.active=!1}).start())},.5)},e.prototype.onDestroy=function(){this.startButton&&this.startButton.node&&this.startButton.node.off("click",this.onStartClick,this),this.backButton&&this.backButton.node&&this.backButton.node.off("click",this.onBackClick,this)},e.prototype.onStartClick=function(){console.log("start-btn pressed\uff01"),cc.director.loadScene("level-1")},e.prototype.onBackClick=function(){console.log("back-btn pressed\uff01"),cc.director.loadScene("selectScene")},r([s(cc.Button)],e.prototype,"startButton",void 0),r([s(cc.Button)],e.prototype,"backButton",void 0),r([s(cc.Sprite)],e.prototype,"black",void 0),r([s(cc.Sprite)],e.prototype,"mask",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],"score-scene":[function(t,e,o){"use strict";cc._RF.push(e,"b0f45GVtTlBsaW0SAQ1D0w5","score-scene");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c},c=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(i,r){function c(t){try{s(n.next(t))}catch(e){r(e)}}function a(t){try{s(n.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(c,a)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var o,n,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return s([t,e])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,n=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=e.call(t,c)}catch(a){r=[6,a],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,p=s.ccclass,l=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scoreLabel=null,e.sceneLabel=null,e.resultBgm=null,e.star1Prefab=null,e.star2Prefab=null,e.star3Prefab=null,e.starParent=null,e.char1Node=null,e.char1Frames=[],e.char2Node=null,e.char2Frames=[],e.char1FrameIdx=0,e.char2FrameIdx=0,e._sceneChanged=!1,e}return i(e,t),e.prototype.start=function(){return c(this,void 0,void 0,function(){var t,e,o,n,i,r,c,s,p,l,h,u,d,f,y,g,v,b,m=this;return a(this,function(a){switch(a.label){case 0:return cc.audioEngine.stopMusic(),cc.audioEngine.playMusic(this.resultBgm,!0),(t=cc.director.getScene().getChildByName("ScorePersist"))?(e=t.getComponent("ScorePersist"),o=e.score||0,n=e.fromScene||"",(i=cc.director.getScene().getChildByName("PersistentUser"))?[3,1]:(cc.warn("\u627e\u4e0d\u5230 PersistentUser persist node\uff0c\u7121\u6cd5\u540c\u6b65\u5206\u6578"),[3,10])):(cc.error("\u627e\u4e0d\u5230 ScorePersist persist node"),[2]);case 1:if(r=i.getComponent("PersistentUser"),c=r.userId,s=r.nickname||"",!c)return[3,9];a.label=2;case 2:return a.trys.push([2,7,,8]),p=firebase.database(),[4,(l=p.ref("scores/"+c)).once("value")];case 3:return h=a.sent(),u=h.val()?h.val().score:0,o>u?[4,l.set({score:o,scene:n,username:s})]:[3,5];case 4:return a.sent(),cc.log("\u5206\u6578\u5df2\u5237\u65b0\u5230 Firebase"),[3,6];case 5:cc.log("\u5206\u6578\u672a\u5237\u65b0\uff08\u672a\u8d85\u904e\u820a\u5206\u6578\uff09"),a.label=6;case 6:return[3,8];case 7:return d=a.sent(),cc.error("Firebase \u66f4\u65b0\u5206\u6578\u5931\u6557",d),[3,8];case 8:return[3,10];case 9:cc.warn("userId \u5c1a\u672a\u8a2d\u5b9a\uff0c\u7121\u6cd5\u540c\u6b65\u5206\u6578"),a.label=10;case 10:if(this.scoreLabel&&(this.scoreLabel.string=""+o),this.sceneLabel&&(this.sceneLabel.string=n),f=[],o>=500?f=[this.star3Prefab,this.star2Prefab,this.star1Prefab]:o>=200?f=[this.star2Prefab,this.star1Prefab]:o>=50&&(f=[this.star1Prefab]),this.starParent)for(y=0,g=f;y<g.length;y++)(v=g[y])&&(b=cc.instantiate(v),this.starParent.addChild(b));return this.schedule(this.updateCharFrames,.25),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),this.scheduleOnce(function(){m.gotoMenu()},10),[2]}})})},e.prototype.onDestroy=function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.onKeyDown=function(t){t.keyCode===cc.macro.KEY.space&&this.gotoMenu()},e.prototype.gotoMenu=function(){this._sceneChanged||(this._sceneChanged=!0,cc.director.loadScene("selectScene"))},e.prototype.updateCharFrames=function(){if(this.char1Node&&this.char1Frames.length>0){var t=this.char1Node.getComponent(cc.Sprite);t&&(t.spriteFrame=this.char1Frames[this.char1FrameIdx],this.char1FrameIdx=(this.char1FrameIdx+1)%this.char1Frames.length)}if(this.char2Node&&this.char2Frames.length>0){var e=this.char2Node.getComponent(cc.Sprite);e&&(e.spriteFrame=this.char2Frames[this.char2FrameIdx],this.char2FrameIdx=(this.char2FrameIdx+1)%this.char2Frames.length)}},r([l(cc.Label)],e.prototype,"scoreLabel",void 0),r([l(cc.Label)],e.prototype,"sceneLabel",void 0),r([l({type:cc.AudioClip})],e.prototype,"resultBgm",void 0),r([l({type:cc.Prefab})],e.prototype,"star1Prefab",void 0),r([l({type:cc.Prefab})],e.prototype,"star2Prefab",void 0),r([l({type:cc.Prefab})],e.prototype,"star3Prefab",void 0),r([l({type:cc.Node})],e.prototype,"starParent",void 0),r([l({type:cc.Node})],e.prototype,"char1Node",void 0),r([l({type:[cc.SpriteFrame]})],e.prototype,"char1Frames",void 0),r([l({type:cc.Node})],e.prototype,"char2Node",void 0),r([l({type:[cc.SpriteFrame]})],e.prototype,"char2Frames",void 0),r([p],e)}(cc.Component);o.default=h,cc._RF.pop()},{}],scoreboardCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"c754aJApt5Cs5F3KkujCpRm","scoreboardCtrl");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.content=null,e.itemPrefab=null,e.backButton=null,e}return i(e,t),e.prototype.start=function(){this.loadLeaderboard(),this.backButton.node.on("click",this.onBackButtonClicked,this)},e.prototype.onBackButtonClicked=function(){cc.director.loadScene("Menu")},e.prototype.loadLeaderboard=function(){var t=this;firebase.database().ref("scores").orderByChild("score").limitToLast(5).once("value",function(e){var o=e.val();if(o){var n=Object.values(o).sort(function(t,e){return e.score-t.score});t.content.removeAllChildren(),n.forEach(function(e,o){var n=cc.instantiate(t.itemPrefab);n.active=!0;var i=n.getComponentInChildren(cc.Label);i&&(i.string=o+1+". "+e.username+"  "+e.score),n.setPosition(0,60*-o),t.content.addChild(n)})}})},r([s(cc.Node)],e.prototype,"content",void 0),r([s(cc.Prefab)],e.prototype,"itemPrefab",void 0),r([s(cc.Button)],e.prototype,"backButton",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],uiManager:[function(t,e,o){"use strict";cc._RF.push(e,"f834buWLXlIMIgzpwunUQfn","uiManager");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.slots=[],e.dishPrefabs=[],e.timerLabel=null,e.timeUpPrefab=null,e.scoreLabel=null,e.totalTime=60,e.dishesPerGame=3,e.dishInterval=5,e.bgm=null,e.tenSecBgm=null,e.fireEffectPrefab=null,e.timerNode=null,e.isShaking=!1,e.fireEffectNode=null,e.isFireShown=!1,e.currentDishIdx=0,e.currentTime=0,e.score=0,e}return i(e,t),e.prototype.start=function(){this.resetMenu(),this.startGame(),this.bgm&&cc.audioEngine.playMusic(this.bgm,!0)},e.prototype.checkAndFillSlots=function(){for(var t=this.slots.filter(function(t){return t.children.length>0}).length;t<this.slots.length;)this.generateNextDish(),t++},e.prototype.resetMenu=function(){for(var t=0,e=this.slots;t<e.length;t++)e[t].removeAllChildren();this.currentDishIdx=0,this.unschedule(this.generateNextDish),this.unschedule(this.countdownStep),this.setScore(0)},e.prototype.startGame=function(){var t=this;this.currentTime=this.totalTime,this.updateLabel(),this.schedule(this.countdownStep,1),this.generateNextDish(),this.schedule(this.generateNextDish,this.dishInterval),this.setScore(0),this.tenSecBgm&&this.totalTime>10&&this.scheduleOnce(function(){cc.audioEngine.stopMusic(),cc.audioEngine.playMusic(t.tenSecBgm,!0)},this.totalTime-10)},e.prototype.countdownStep=function(){this.currentTime>0&&(this.currentTime--,this.updateLabel(),10!==this.currentTime||this.fireEffectNode||this.spawnFireEffect(),10!==this.currentTime||this.isShaking||this.startTimerShake(),0===this.currentTime&&(this.timeUp(),this.stopTimerShake()))},e.prototype.stopTimerShake=function(){this.timerNode&&cc.Tween.stopAllByTarget(this.timerNode),this.isShaking=!1},e.prototype.startTimerShake=function(){this.timerNode&&(this.isShaking=!0,cc.tween(this.timerNode).repeatForever(cc.tween().by(.05,{position:cc.v3(2,0,0)}).by(.05,{position:cc.v3(-4,0,0)}).by(.05,{position:cc.v3(2,0,0)})).start())},e.prototype.spawnFireEffect=function(){if(this.fireEffectPrefab&&this.timerNode){this.fireEffectNode=cc.instantiate(this.fireEffectPrefab);var t=this.timerNode.getPosition(),e=cc.v2(0,50),o=t.add(e);this.fireEffectNode.setPosition(o),this.timerNode.parent.addChild(this.fireEffectNode)}},e.prototype.updateLabel=function(){this.timerLabel.string=this.formatTime(this.currentTime)},e.prototype.formatTime=function(t){var e=t%60;return Math.floor(t/60)+":"+(e<10?"0":"")+e},e.prototype.generateNextDish=function(){var t=this.slots.findIndex(function(t){return 0===t.children.length});if(-1!==t){var e=Math.floor(Math.random()*this.dishPrefabs.length),o=cc.instantiate(this.dishPrefabs[e]);o.setPosition(cc.v3(800,0,0)),this.slots[t].addChild(o),cc.tween(o).to(.5,{position:cc.v3(0,0,0)},{easing:"cubicOut"}).start()}},e.prototype.timeUp=function(){var t=this;if(this.unschedule(this.countdownStep),this.unschedule(this.generateNextDish),cc.log("Time's up!"),this.timeUpPrefab){var e=cc.instantiate(this.timeUpPrefab);this.node.addChild(e),cc.director.pause(),setTimeout(function(){cc.director.resume(),cc.director.loadScene("score-scene"),t.saveScoreAndGotoResult()},2e3)}},e.prototype.saveScoreAndGotoResult=function(){var t=cc.director.getScene().getChildByName("ScorePersist");if(t){var e=t.getComponent("ScorePersist");e.score=this.score,e.fromScene=cc.director.getScene().name}else cc.error("\u627e\u4e0d\u5230 ScorePersist persist node");cc.director.loadScene("ResultScene")},e.prototype.resetAndStart=function(){this.resetMenu(),this.startGame()},e.prototype.setScore=function(t){this.score=t,this.scoreLabel&&(this.scoreLabel.string=""+this.score)},e.prototype.getScore=function(){return this.score},e.prototype.addScore=function(t){this.setScore(this.score+t)},r([s({type:[cc.Node]})],e.prototype,"slots",void 0),r([s({type:[cc.Prefab]})],e.prototype,"dishPrefabs",void 0),r([s({type:cc.Label})],e.prototype,"timerLabel",void 0),r([s({type:cc.Prefab})],e.prototype,"timeUpPrefab",void 0),r([s({type:cc.Label})],e.prototype,"scoreLabel",void 0),r([s],e.prototype,"totalTime",void 0),r([s],e.prototype,"dishesPerGame",void 0),r([s],e.prototype,"dishInterval",void 0),r([s({type:cc.AudioClip})],e.prototype,"bgm",void 0),r([s({type:cc.AudioClip})],e.prototype,"tenSecBgm",void 0),r([s({type:cc.Prefab})],e.prototype,"fireEffectPrefab",void 0),r([s({type:cc.Node})],e.prototype,"timerNode",void 0),r([a("MenuBar")],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],vehicleCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"b911baxZ3VAmZg5mjT3jvdC","vehicleCtrl");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=t("./PositionManager"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.speed=3,e.rb=null,e.velocity=cc.v3(),e}return i(e,t),e.prototype.onLoad=function(){this.rb=this.getComponent(cc.RigidBody3D);var t="true"===cc.sys.localStorage.getItem("fromMenu")?null:p.default.getSavedPosition();t&&(this.node.setPosition(t),p.default.clear()),cc.sys.localStorage.removeItem("fromMenu"),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.start=function(){console.log("character's forward: ",this.node.forward)},e.prototype.onDestroy=function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.onKeyDown=function(t){t.keyCode===cc.macro.KEY.a&&(this.velocity.x=-this.speed),t.keyCode===cc.macro.KEY.d&&(this.velocity.x=this.speed),t.keyCode===cc.macro.KEY.w&&(this.velocity.z=-this.speed),t.keyCode===cc.macro.KEY.s&&(this.velocity.z=this.speed)},e.prototype.onKeyUp=function(t){t.keyCode!==cc.macro.KEY.a&&t.keyCode!==cc.macro.KEY.d||(this.velocity.x=0),t.keyCode!==cc.macro.KEY.w&&t.keyCode!==cc.macro.KEY.s||(this.velocity.z=0)},e.prototype.update=function(t){if(this.rb&&(this.rb.setLinearVelocity(this.velocity),!this.velocity.equals(cc.Vec3.ZERO))){var e=this.velocity.clone().normalize(),o=new cc.Quat;cc.Quat.fromViewUp(o,e,cc.Vec3.UP);var n=new cc.Quat;this.node.getRotation(n);var i=new cc.Quat;cc.Quat.slerp(i,n,o,10*t),this.node.setRotation(i)}var r=cc.find("vehicle/garbage-truck");r&&r.getPosition().y<-2.5&&r.setPosition(-.069,.15,.446)},r([s],e.prototype,"speed",void 0),r([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./PositionManager":"PositionManager"}]},{},["CattyController","CattySpawner","GoblinController","GoblinSpawner","NPCWanderCatty","NPCWanderGoblin","PauseManager","PersistentUser","GamepadControls","IInputControls","KeyboardControls","KeyboardControls2","Level2icecream1","Level2icecream2","PlayerController 2","PlayerController","debug","ScorePersist","score-scene","uiManager","AudioManager","AutoSceneSwitcher","CameraAutoMove2D","CloseButton","ExpandButton","ExpandPage","FirebaseManager","GameManager-level1","GoToPage","Login","MenuManager","OpenShop","PlayerAnimationController","PlayerModeSelector","PlayerModeWatcher","ShowImageOnPlane","Signup","scoreboardCtrl","BGMManager","GameManager","PositionManager","cameraCtrl","flagTrigger","hintAnimation","icecreamCheck","maskTransition3D","pizzaCheck","vehicleCtrl"]);