{"version":3,"sources":["assets/Script/script/Login.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\nimport FirebaseManager from './FirebaseManager';\n\n@ccclass\nexport default class Login extends cc.Component {\n    private firebaseManager: FirebaseManager = null;\n\n    start() {\n         //cc.director.loadScene(\"Loading\"); \n        // 使用新的方式獲取 FirebaseManager 實例\n        this.firebaseManager = FirebaseManager.getFirebaseManager();\n        if (!this.firebaseManager.isFirebaseInitialized()) {\n            console.error(\"Firebase not initialized!\");\n            return;\n        }\n\n        let continueButton = new cc.Component.EventHandler();\n        continueButton.target = this.node;\n        continueButton.component = \"Login\";\n        continueButton.handler = \"onLogin\";\n        \n        cc.find(\"Canvas/Login/Submit\").getComponent(cc.Button).clickEvents.push(continueButton);\n    }\n\n    onLogin() {\n        // 檢查輸入是否為空\n        const email = cc.find(\"Canvas/Login/Email\").getComponent(cc.EditBox).string;\n        const password = cc.find(\"Canvas/Login/Password\").getComponent(cc.EditBox).string;\n\n        if (!email || !password) {\n            alert(\"請填寫所有欄位\");\n            return;\n        }\n\n        // 檢查 email 格式\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        if (!emailRegex.test(email)) {\n            alert(\"請輸入有效的電子郵件地址\");\n            return;\n        }\n\n        console.log(\"嘗試登入:\", email);\n        \n        // 使用 FirebaseManager 進行登入\n        this.firebaseManager.getAuth().signInWithEmailAndPassword(email, password)\n            .then((userCredential) => {\n                console.log(\"登入成功:\", userCredential.user.email);\n                this.loadMenuPage();\n            })\n            .catch((error) => {\n                console.error(\"登入錯誤:\", error);\n                switch (error.code) {\n                    case 'auth/invalid-credential':\n                        alert(\"帳號或密碼錯誤\");\n                        break;\n                    case 'auth/user-not-found':\n                        alert(\"找不到此用戶\");\n                        break;\n                    case 'auth/wrong-password':\n                        alert(\"密碼錯誤\");\n                        break;\n                    default:\n                        alert(error.message);\n                }\n            });\n    }\n\n    loadMenuPage() {\n        cc.director.loadScene(\"Loading\");\n    }\n}\n \n"]}