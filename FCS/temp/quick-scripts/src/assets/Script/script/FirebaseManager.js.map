{"version":3,"sources":["assets\\Script\\script\\FirebaseManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class FirebaseManager extends cc.Component {\r\n    private static instance: FirebaseManager = null;\r\n    private isInitialized: boolean = false;\r\n\r\n    private readonly firebaseConfig= {\r\n    apiKey: \"AIzaSyBDxNDyXpBYaxPqu_67VOdiBpHktm07Lvg\",\r\n    authDomain: \"fastcomespeed.firebaseapp.com\",\r\n    databaseURL: \"https://fastcomespeed-default-rtdb.firebaseio.com\",\r\n    projectId: \"fastcomespeed\",\r\n    storageBucket: \"fastcomespeed.firebasestorage.app\",\r\n    messagingSenderId: \"1000911495183\",\r\n    appId: \"1:1000911495183:web:8acc6cb6b915d6687e437a\",\r\n    measurementId: \"G-JMECN9BKDF\"\r\n    };\r\n    \r\n\r\n    onLoad() {\r\n        //alert(\"FirebaseManager onLoad\");\r\n        if (FirebaseManager.instance === null) {\r\n            FirebaseManager.instance = this;\r\n            cc.game.addPersistRootNode(this.node);\r\n            this.initializeFirebase();\r\n        } else {\r\n            this.node.destroy();\r\n        }\r\n    }\r\n\r\n    private initializeFirebase() {\r\n        try {\r\n            if (!this.isInitialized) {\r\n                const app = firebase.initializeApp(this.firebaseConfig);\r\n                //alert(app);\r\n                this.isInitialized = true;\r\n                console.log(\"Firebase initialized successfully:\", app);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Firebase initialization error:\", error);\r\n            // 如果已經初始化過，會拋出錯誤，這是正常的\r\n            if (error.code === 'app/duplicate-app') {\r\n                this.isInitialized = true;\r\n                console.warn(\"Firebase app already initialized, using existing instance.\");\r\n            }\r\n            else{\r\n                alert(error);\r\n            }\r\n        }\r\n    }\r\n\r\n    public static getInstance(): FirebaseManager {\r\n        return FirebaseManager.instance;\r\n    }\r\n\r\n    public isFirebaseInitialized(): boolean {\r\n        return this.isInitialized;\r\n    }\r\n\r\n    public getAuth() {\r\n        if (!this.isInitialized) {\r\n            throw new Error(\"Firebase not initialized\");\r\n        }\r\n        return firebase.auth();\r\n    }\r\n\r\n    public getDatabase() {\r\n        if (!this.isInitialized) {\r\n            throw new Error(\"Firebase not initialized\");\r\n        }\r\n        return firebase.database();\r\n    }\r\n\r\n    public static getFirebaseManager(): FirebaseManager {\r\n        if (FirebaseManager.instance === null) {\r\n            console.warn(\"FirebaseManager instance is null, creating a new one.\");\r\n            const node = new cc.Node('FirebaseManager');\r\n            cc.game.addPersistRootNode(node);\r\n            return node.addComponent(FirebaseManager);\r\n        }\r\n        return FirebaseManager.instance;\r\n    }\r\n} "]}