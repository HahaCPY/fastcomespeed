{"version":3,"sources":["assets/Script/script/ExpandButton.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class DropdownButton extends cc.Component {\n    @property(cc.Node)\n    dropdownMenu: cc.Node = null;\n\n    private isExpanded: boolean = false;\n\n    onLoad() {\n        this.dropdownMenu.active = false;\n        this.node.on(cc.Node.EventType.TOUCH_END, this.toggleMenu, this);\n    }\n\n    start() {\n        // 确保菜单初始状态\n        this.dropdownMenu.active = false;\n    }\n\n    toggleMenu() {\n        this.isExpanded = !this.isExpanded;\n        \n        if (this.isExpanded) {\n            this.showMenu();\n        } else {\n            this.hideMenu();\n        }\n    }\n\n    showMenu() {\n        this.dropdownMenu.active = true;\n        \n        // 添加淡入动画\n        this.dropdownMenu.opacity = 0;\n        cc.tween(this.dropdownMenu)\n            .to(0.2, { opacity: 255 })\n            .start();\n\n        // 监听全局触摸\n        cc.Canvas.instance.node.on(cc.Node.EventType.TOUCH_START, this.onGlobalTouch, this);\n    }\n\n    hideMenu() {\n        // 添加淡出动画\n        cc.tween(this.dropdownMenu)\n            .to(0.2, { opacity: 0 })\n            .call(() => {\n                this.dropdownMenu.active = false;\n                cc.Canvas.instance.node.off(cc.Node.EventType.TOUCH_START, this.onGlobalTouch, this);\n            })\n            .start();\n    }\n\n    onGlobalTouch(event: cc.Event.EventTouch) {\n        const touchPos = this.node.parent.convertToNodeSpaceAR(event.getLocation());\n        \n        if (!this.node.getBoundingBox().contains(touchPos)) {\n            if (!this.dropdownMenu.active || \n                !this.dropdownMenu.getBoundingBox().contains(touchPos)) {\n                this.isExpanded = false;\n                this.hideMenu();\n            }\n        }\n    }\n\n    onDestroy() {\n        // 移除所有监听\n        this.node.off(cc.Node.EventType.TOUCH_END, this.toggleMenu, this);\n        cc.Canvas.instance.node.off(cc.Node.EventType.TOUCH_START, this.onGlobalTouch, this);\n    }\n}"]}