{"version":3,"sources":["assets/Script/scene/uiManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\n\n@ccclass(\"MenuBar\") \nexport default class MenuBar extends cc.Component {\n    @property({ type: [cc.Node] })\n    slots: cc.Node[] = [];\n\n    @property({ type: [cc.Prefab] })\n    dishPrefabs: cc.Prefab[] = [];\n\n    @property({ type: cc.Label })\n    timerLabel: cc.Label = null; // 拖拉倒數時間的 Label\n\n    @property({ type: cc.Label })\n    scoreLabel: cc.Label = null; // 拖拉分數的 Label\n\n    @property\n    totalTime: number = 60; // 總倒數秒數\n\n    @property\n    dishesPerGame: number = 3; // 格子數\n\n    @property\n    dishInterval: number = 5;  // 每隔幾秒產生一個\n\n    @property({ type: cc.AudioClip })\n    bgm: cc.AudioClip = null;\n\n\n    private currentDishIdx: number = 0;\n    private currentTime: number = 0;\n    private score: number = 0; // 加這行\n\n    start() {\n        this.resetMenu();\n        this.startGame();\n        if (this.bgm) {\n            cc.audioEngine.playMusic(this.bgm, true);\n        }\n    }\n\n    /** 確保場上一直維持 4 道菜 */\n    checkAndFillSlots() {\n        let currentCount = this.slots.filter(slot => slot.children.length > 0).length;\n        while (currentCount < this.slots.length) {\n            this.generateNextDish();\n            currentCount++;\n        }\n    }\n\n\n    resetMenu() {\n        for (let slot of this.slots) {\n            slot.removeAllChildren();\n        }\n        this.currentDishIdx = 0;\n        this.unschedule(this.generateNextDish);\n        this.unschedule(this.countdownStep);\n\n        this.setScore(0); // 分數歸零\n    }\n\n    startGame() {\n        this.currentTime = this.totalTime;\n        this.updateLabel();\n\n        this.schedule(this.countdownStep, 1);\n        this.generateNextDish();\n        this.schedule(this.generateNextDish, this.dishInterval);\n\n        this.setScore(0); // 遊戲開始分數歸零\n    }\n\n    countdownStep() {\n        if (this.currentTime > 0) {\n            this.currentTime--;\n            this.updateLabel();\n\n            if (this.currentTime === 0) {\n                this.timeUp();\n            }\n        }\n    }\n\n    updateLabel() {\n        this.timerLabel.string = this.formatTime(this.currentTime);\n    }\n\n    formatTime(sec: number): string {\n        const m = Math.floor(sec / 60);\n        const s = sec % 60;\n        return `${m}:${s < 10 ? '0' : ''}${s}`;\n    }\n\n    \n\n    generateNextDish() {\n        // 找第一個空的 slot\n        let emptySlotIndex = this.slots.findIndex(slot => slot.children.length === 0);\n        if (emptySlotIndex === -1) return;\n\n        let prefabIdx = Math.floor(Math.random() * this.dishPrefabs.length);\n        let dish = cc.instantiate(this.dishPrefabs[prefabIdx]);\n\n        // 初始位置在螢幕右外側（z 軸設 0）\n        dish.setPosition(cc.v3(800, 0, 0));  // ✅ 改成 Vec3\n        this.slots[emptySlotIndex].addChild(dish);\n\n        // 動畫滑進 slot 中心（也是 Vec3）\n        cc.tween(dish)\n            .to(0.5, { position: cc.v3(0, 0, 0) }, { easing: 'cubicOut' })  // ✅ Vec3\n            .start();\n    }\n\n\n    timeUp() {\n        this.unschedule(this.countdownStep);\n        this.unschedule(this.generateNextDish);\n        cc.log(\"Time's up!\");\n    }\n\n    resetAndStart() {\n        this.resetMenu();\n        this.startGame();\n    }\n\n    // =============== 新增 ===============\n    /** 設定分數，外部可呼叫 */\n    setScore(newScore: number) {\n        this.score = newScore;\n        if (this.scoreLabel) {\n            this.scoreLabel.string = `${this.score}`;\n        }\n    }\n\n    /** 取得目前分數 */\n    getScore(): number {\n        return this.score;\n    }\n\n    /** 分數加減 n，可依需求使用 */\n    addScore(delta: number) {\n        this.setScore(this.score + delta);\n    }\n    // ===================================\n}\n"]}