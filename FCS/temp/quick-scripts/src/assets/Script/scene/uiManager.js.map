{"version":3,"sources":["assets\\Script\\scene\\uiManager.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAM,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAAqC,2BAAY;IAAjD;QAAA,qEA2FC;QAzFG,WAAK,GAAc,EAAE,CAAC;QAGtB,iBAAW,GAAgB,EAAE,CAAC;QAG9B,gBAAU,GAAa,IAAI,CAAC,CAAC,gBAAgB;QAG7C,eAAS,GAAW,EAAE,CAAC,CAAC,QAAQ;QAGhC,mBAAa,GAAW,CAAC,CAAC,CAAC,MAAM;QAGjC,kBAAY,GAAW,CAAC,CAAC,CAAE,WAAW;QAE9B,oBAAc,GAAW,CAAC,CAAC;QAC3B,iBAAW,GAAW,CAAC,CAAC;;IAuEpC,CAAC;IArEG,uBAAK,GAAL;QACI,IAAI,CAAC,SAAS,EAAE,CAAC;QACjB,IAAI,CAAC,SAAS,EAAE,CAAC;IACrB,CAAC;IAED,2BAAS,GAAT;QACI,KAAiB,UAAU,EAAV,KAAA,IAAI,CAAC,KAAK,EAAV,cAAU,EAAV,IAAU,EAAE;YAAxB,IAAI,IAAI,SAAA;YACT,IAAI,CAAC,iBAAiB,EAAE,CAAC;SAC5B;QACD,IAAI,CAAC,cAAc,GAAG,CAAC,CAAC;QACxB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;QACvC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;IACxC,CAAC;IAED,2BAAS,GAAT;QACI,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC;QAClC,IAAI,CAAC,WAAW,EAAE,CAAC;QAEnB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC;QACrC,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACxB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;IAC5D,CAAC;IAED,+BAAa,GAAb;QACI,IAAI,IAAI,CAAC,WAAW,GAAG,CAAC,EAAE;YACtB,IAAI,CAAC,WAAW,EAAE,CAAC;YACnB,IAAI,CAAC,WAAW,EAAE,CAAC;YAEnB,IAAI,IAAI,CAAC,WAAW,KAAK,CAAC,EAAE;gBACxB,IAAI,CAAC,MAAM,EAAE,CAAC;aACjB;SACJ;IACL,CAAC;IAED,6BAAW,GAAX;QACI,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;IAC/D,CAAC;IAED,4BAAU,GAAV,UAAW,GAAW;QAClB,IAAM,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,EAAE,CAAC,CAAC;QAC/B,IAAM,CAAC,GAAG,GAAG,GAAG,EAAE,CAAC;QACnB,OAAU,CAAC,UAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,IAAG,CAAG,CAAC;IAC3C,CAAC;IAED,kCAAgB,GAAhB;QACI,uBAAuB;QACvB,IAAI,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE;YAC1C,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;YACvC,OAAO;SACV;QACD,IAAI,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;QACpE,IAAI,IAAI,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC,CAAC;QACvD,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;QAC/C,IAAI,CAAC,cAAc,EAAE,CAAC;IAC1B,CAAC;IAGD,wBAAM,GAAN;QACI,gBAAgB;QAChB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QACpC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;QACvC,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC,CAAC,WAAW;IACrC,CAAC;IAED,OAAO;IACP,+BAAa,GAAb;QACI,IAAI,CAAC,SAAS,EAAE,CAAC;QACjB,IAAI,CAAC,SAAS,EAAE,CAAC;IACrB,CAAC;IAxFD;QADC,QAAQ,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC;0CACR;IAGtB;QADC,QAAQ,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,MAAM,CAAC,EAAE,CAAC;gDACF;IAG9B;QADC,QAAQ,CAAC,EAAE,IAAI,EAAE,EAAE,CAAC,KAAK,EAAE,CAAC;+CACD;IAG5B;QADC,QAAQ;8CACc;IAGvB;QADC,QAAQ;kDACiB;IAG1B;QADC,QAAQ;iDACgB;IAjBR,OAAO;QAD3B,OAAO;OACa,OAAO,CA2F3B;IAAD,cAAC;CA3FD,AA2FC,CA3FoC,EAAE,CAAC,SAAS,GA2FhD;kBA3FoB,OAAO","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class MenuBar extends cc.Component {\r\n    @property({ type: [cc.Node] })\r\n    slots: cc.Node[] = [];\r\n\r\n    @property({ type: [cc.Prefab] })\r\n    dishPrefabs: cc.Prefab[] = [];\r\n\r\n    @property({ type: cc.Label })\r\n    timerLabel: cc.Label = null; // 拖拉倒數時間的 Label\r\n\r\n    @property\r\n    totalTime: number = 60; // 總倒數秒數\r\n\r\n    @property\r\n    dishesPerGame: number = 3; // 格子數\r\n\r\n    @property\r\n    dishInterval: number = 5;  // 每隔幾秒產生一個\r\n\r\n    private currentDishIdx: number = 0;\r\n    private currentTime: number = 0;\r\n\r\n    start() {\r\n        this.resetMenu();\r\n        this.startGame();\r\n    }\r\n\r\n    resetMenu() {\r\n        for (let slot of this.slots) {\r\n            slot.removeAllChildren();\r\n        }\r\n        this.currentDishIdx = 0;\r\n        this.unschedule(this.generateNextDish);\r\n        this.unschedule(this.countdownStep);\r\n    }\r\n\r\n    startGame() {\r\n        this.currentTime = this.totalTime;\r\n        this.updateLabel();\r\n\r\n        this.schedule(this.countdownStep, 1);\r\n        this.generateNextDish();\r\n        this.schedule(this.generateNextDish, this.dishInterval);\r\n    }\r\n\r\n    countdownStep() {\r\n        if (this.currentTime > 0) {\r\n            this.currentTime--;\r\n            this.updateLabel();\r\n\r\n            if (this.currentTime === 0) {\r\n                this.timeUp();\r\n            }\r\n        }\r\n    }\r\n\r\n    updateLabel() {\r\n        this.timerLabel.string = this.formatTime(this.currentTime);\r\n    }\r\n\r\n    formatTime(sec: number): string {\r\n        const m = Math.floor(sec / 60);\r\n        const s = sec % 60;\r\n        return `${m}:${s < 10 ? '0' : ''}${s}`;\r\n    }\r\n\r\n    generateNextDish() {\r\n        // 用 slots.length 當最大格數\r\n        if (this.currentDishIdx >= this.slots.length) {\r\n            this.unschedule(this.generateNextDish);\r\n            return;\r\n        }\r\n        let prefabIdx = Math.floor(Math.random() * this.dishPrefabs.length);\r\n        let dish = cc.instantiate(this.dishPrefabs[prefabIdx]);\r\n        this.slots[this.currentDishIdx].addChild(dish);\r\n        this.currentDishIdx++;\r\n    }\r\n\r\n\r\n    timeUp() {\r\n        // 停止所有 schedule\r\n        this.unschedule(this.countdownStep);\r\n        this.unschedule(this.generateNextDish);\r\n        cc.log(\"Time's up!\"); // 你可以加更多動作\r\n    }\r\n\r\n    // 若需重啟\r\n    resetAndStart() {\r\n        this.resetMenu();\r\n        this.startGame();\r\n    }\r\n}\r\n"]}