{"version":3,"sources":["assets/Script/scene/score-scene.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class ResultScene extends cc.Component {\n    @property(cc.Label)\n    scoreLabel: cc.Label = null;\n\n    @property(cc.Label)\n    sceneLabel: cc.Label = null;  // <== 新增，拖 UI Label 進來\n\n    @property({ type: cc.Prefab })\n    star1Prefab: cc.Prefab = null;\n\n    @property({ type: cc.Prefab })\n    star2Prefab: cc.Prefab = null;\n\n    @property({ type: cc.Prefab })\n    star3Prefab: cc.Prefab = null;\n\n    @property({ type: cc.Node })\n    starParent: cc.Node = null;\n\n    @property({ type: cc.Node })\n    char1Node: cc.Node = null;\n    @property({ type: [cc.SpriteFrame] })\n    char1Frames: cc.SpriteFrame[] = [];   // 3張圖片\n\n    @property({ type: cc.Node })\n    char2Node: cc.Node = null;\n    @property({ type: [cc.SpriteFrame] })\n    char2Frames: cc.SpriteFrame[] = [];   // 3張圖片\n\n    private char1FrameIdx = 0;\n    private char2FrameIdx = 0;\n\n    start() {\n        // 取得 persist node\n        const persistNode = cc.director.getScene().getChildByName('ScorePersist');\n        if (!persistNode) {\n            cc.error('找不到 ScorePersist persist node');\n            return;\n        }\n        const persistScript = persistNode.getComponent('ScorePersist');\n        const score = persistScript.score || 0;\n        const fromScene = persistScript.fromScene || '';\n\n        // 顯示分數\n        if (this.scoreLabel) {\n            this.scoreLabel.string = `${score}`;\n        }\n\n        // 顯示來源場景名稱\n        if (this.sceneLabel) {\n            this.sceneLabel.string = fromScene;\n        }\n\n        // 根據分數顯示 n 顆星\n        let starPrefabs = [];\n        if (score >= 150) {\n            starPrefabs = [this.star3Prefab, this.star2Prefab, this.star1Prefab];\n        } else if (score >= 100) {\n            starPrefabs = [this.star2Prefab, this.star1Prefab];\n        } else if (score > 60) {\n            starPrefabs = [this.star1Prefab];\n        }\n\n        // 實例化並顯示\n        if (this.starParent) {\n            for (let prefab of starPrefabs) {\n                if (prefab) {\n                    const node = cc.instantiate(prefab);\n                    this.starParent.addChild(node);\n                }\n            }\n        }\n\n        this.schedule(this.updateCharFrames, 0.25);\n    }\n\n    updateCharFrames() {\n        // 角色1\n        if (this.char1Node && this.char1Frames.length > 0) {\n            let sprite1 = this.char1Node.getComponent(cc.Sprite);\n            if (sprite1) {\n                sprite1.spriteFrame = this.char1Frames[this.char1FrameIdx];\n                this.char1FrameIdx = (this.char1FrameIdx + 1) % this.char1Frames.length;\n            }\n        }\n        // 角色2\n        if (this.char2Node && this.char2Frames.length > 0) {\n            let sprite2 = this.char2Node.getComponent(cc.Sprite);\n            if (sprite2) {\n                sprite2.spriteFrame = this.char2Frames[this.char2FrameIdx];\n                this.char2FrameIdx = (this.char2FrameIdx + 1) % this.char2Frames.length;\n            }\n        }\n    }\n}\n"]}