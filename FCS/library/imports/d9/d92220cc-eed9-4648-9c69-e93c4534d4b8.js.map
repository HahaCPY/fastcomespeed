{"version":3,"sources":["assets\\Script\\script\\ExpandButton.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class DropdownButton extends cc.Component {\r\n    @property(cc.Node)\r\n    dropdownMenu: cc.Node = null;\r\n\r\n    private isExpanded: boolean = false;\r\n\r\n    onLoad() {\r\n        this.dropdownMenu.active = false;\r\n        this.node.on(cc.Node.EventType.TOUCH_END, this.toggleMenu, this);\r\n    }\r\n\r\n    start() {\r\n        // 确保菜单初始状态\r\n        this.dropdownMenu.active = false;\r\n    }\r\n\r\n    toggleMenu() {\r\n        this.isExpanded = !this.isExpanded;\r\n        \r\n        if (this.isExpanded) {\r\n            this.showMenu();\r\n        } else {\r\n            this.hideMenu();\r\n        }\r\n    }\r\n\r\n    showMenu() {\r\n        this.dropdownMenu.active = true;\r\n        \r\n        // 添加淡入动画\r\n        this.dropdownMenu.opacity = 0;\r\n        cc.tween(this.dropdownMenu)\r\n            .to(0.2, { opacity: 255 })\r\n            .start();\r\n\r\n        // 监听全局触摸\r\n        cc.Canvas.instance.node.on(cc.Node.EventType.TOUCH_START, this.onGlobalTouch, this);\r\n    }\r\n\r\n    hideMenu() {\r\n        // 添加淡出动画\r\n        cc.tween(this.dropdownMenu)\r\n            .to(0.2, { opacity: 0 })\r\n            .call(() => {\r\n                this.dropdownMenu.active = false;\r\n                cc.Canvas.instance.node.off(cc.Node.EventType.TOUCH_START, this.onGlobalTouch, this);\r\n            })\r\n            .start();\r\n    }\r\n\r\n    onGlobalTouch(event: cc.Event.EventTouch) {\r\n        const touchPos = this.node.parent.convertToNodeSpaceAR(event.getLocation());\r\n        \r\n        if (!this.node.getBoundingBox().contains(touchPos)) {\r\n            if (!this.dropdownMenu.active || \r\n                !this.dropdownMenu.getBoundingBox().contains(touchPos)) {\r\n                this.isExpanded = false;\r\n                this.hideMenu();\r\n            }\r\n        }\r\n    }\r\n\r\n    onDestroy() {\r\n        // 移除所有监听\r\n        this.node.off(cc.Node.EventType.TOUCH_END, this.toggleMenu, this);\r\n        cc.Canvas.instance.node.off(cc.Node.EventType.TOUCH_START, this.onGlobalTouch, this);\r\n    }\r\n}"]}